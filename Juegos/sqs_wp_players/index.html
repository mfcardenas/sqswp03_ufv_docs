<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéØ Laboratorio ISO - Juego Educativo Interactivo</title>
    <meta name="description" content="Juego educativo interactivo para aprender y aplicar los est√°ndares ISO de calidad de software">
    <link rel="stylesheet" href="wizard.css">
    <link rel="stylesheet" href="game-styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üéØ</text></svg>">
    <style>
        /* Reset b√°sico */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
        }
    </style>
</head>
<body>
    <!-- Tutorial Wizard -->
    <div id="tutorial-wizard" class="tutorial-wizard">
        <div class="wizard-backdrop"></div>
        <div class="wizard-container">
            <div class="wizard-header">
                <h1 class="wizard-title">üéØ Laboratorio ISO Interactivo</h1>
                <p class="wizard-subtitle">Tu aventura educativa para dominar los est√°ndares de calidad de software</p>
            </div>
            
            <div class="wizard-content">
                <div class="wizard-step active" data-step="1">
                    <div class="step-icon">üéÆ</div>
                    <h2>¬°Bienvenido al Juego!</h2>
                    <p>Aprende los est√°ndares ISO de una forma completamente nueva - ¬°jugando!</p>
                    <div class="game-features">
                        <div class="feature-card">
                            <span class="feature-icon">üèÜ</span>
                            <h3>Sistema de Puntuaci√≥n</h3>
                            <p>Gana puntos tomando decisiones correctas</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">üéØ</span>
                            <h3>Desaf√≠os Interactivos</h3>
                            <p>Completa quizzes y escenarios reales</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">üìà</span>
                            <h3>Progresi√≥n de Nivel</h3>
                            <p>Avanza y desbloquea nuevos contenidos</p>
                        </div>
                    </div>
                </div>
                
                <div class="wizard-step" data-step="2">
                    <div class="step-icon">üé≠</div>
                    <h2>Escenarios de Juego</h2>
                    <p>Explora 4 escenarios interactivos donde tus decisiones importan:</p>
                    <ul class="scenario-list">
                        <li>üõçÔ∏è <strong>E-commerce Platform:</strong> Lidera una startup tecnol√≥gica</li>
                        <li>üè• <strong>Sistema Hospitalario:</strong> Gestiona aplicaciones cr√≠ticas</li>
                        <li>üìä <strong>An√°lisis Financiero:</strong> Desarrolla sistemas de trading</li>
                        <li>üì± <strong>App M√≥vil Social:</strong> Compite en redes sociales</li>
                    </ul>
                </div>
                
                <div class="wizard-step" data-step="3">
                    <div class="step-icon">üéØ</div>
                    <h2>Tipos de Desaf√≠os</h2>
                    <p>Enfrenta diferentes tipos de retos educativos:</p>
                    <div class="challenge-types">
                        <div class="challenge-card">
                            <span class="challenge-icon">ü§î</span>
                            <h3>Decisiones Estrat√©gicas</h3>
                            <p>Toma decisiones que afectan el proyecto</p>
                        </div>
                        <div class="challenge-card">
                            <span class="challenge-icon">‚ö°</span>
                            <h3>Quiz Cronometrado</h3>
                            <p>Responde preguntas contra el tiempo</p>
                        </div>
                        <div class="challenge-card">
                            <span class="challenge-icon">üîß</span>
                            <h3>Construcci√≥n de Requisitos</h3>
                            <p>Dise√±a sistemas siguiendo est√°ndares</p>
                        </div>
                    </div>
                </div>
                
                <div class="wizard-step" data-step="4">
                    <div class="step-icon">üèÜ</div>
                    <h2>Sistema de Recompensas</h2>
                    <p>Tu progreso se recompensa de m√∫ltiples formas:</p>
                    <div class="rewards-grid">
                        <div class="reward-item">
                            <span class="reward-icon">‚≠ê</span>
                            <div>
                                <strong>Puntos de Experiencia</strong>
                                <p>Gana XP por cada decisi√≥n acertada</p>
                            </div>
                        </div>
                        <div class="reward-item">
                            <span class="reward-icon">üéñÔ∏è</span>
                            <div>
                                <strong>Logros</strong>
                                <p>Desbloquea medallas por completar objetivos</p>
                            </div>
                        </div>
                        <div class="reward-item">
                            <span class="reward-icon">üìä</span>
                            <div>
                                <strong>Estad√≠sticas</strong>
                                <p>Rastrea tu rendimiento y mejora</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="wizard-step" data-step="5">
                    <div class="step-icon">üöÄ</div>
                    <h2>¬°Comienza tu Aventura!</h2>
                    <p>Est√°s listo para convertirte en un experto en est√°ndares ISO jugando.</p>
                    <div class="ready-features">
                        <div class="ready-item">
                            <span class="ready-icon">‚úÖ</span>
                            <span>Entiendes el sistema de juego</span>
                        </div>
                        <div class="ready-item">
                            <span class="ready-icon">‚úÖ</span>
                            <span>Conoces los tipos de desaf√≠os</span>
                        </div>
                        <div class="ready-item">
                            <span class="ready-icon">‚úÖ</span>
                            <span>Sabes c√≥mo ganar recompensas</span>
                        </div>
                    </div>
                    <p class="start-message"><strong>¬°Que comience el juego!</strong></p>
                </div>
            </div>
            
            <div class="wizard-navigation">
                <button id="wizard-prev" class="wizard-btn secondary" disabled>‚¨ÖÔ∏è Anterior</button>
                <div class="wizard-indicators">
                    <span class="indicator active"></span>
                    <span class="indicator"></span>
                    <span class="indicator"></span>
                    <span class="indicator"></span>
                    <span class="indicator"></span>
                </div>
                <button id="wizard-next" class="wizard-btn primary">Siguiente ‚û°Ô∏è</button>
                <button id="wizard-start" class="wizard-btn success" style="display: none;">üéÆ ¬°Jugar Ahora!</button>
            </div>
        </div>
    </div>

    <!-- Contenedor Principal del Juego -->
    <div id="game-app" class="game-main-container" style="display: none;">
        <!-- HUD del Jugador -->
        <div class="player-hud">
            <div class="player-stats">
                <div class="stat-item">
                    <span class="stat-icon">‚≠ê</span>
                    <div>
                        <div class="stat-label">Puntuaci√≥n</div>
                        <div id="player-score" class="stat-value">0</div>
                    </div>
                </div>
                <div class="stat-item">
                    <span class="stat-icon">üéØ</span>
                    <div>
                        <div class="stat-label">Nivel</div>
                        <div id="player-level" class="stat-value">1</div>
                    </div>
                </div>
                <div class="stat-item">
                    <span class="stat-icon">üèÜ</span>
                    <div>
                        <div class="stat-label">Logros</div>
                        <div id="player-achievements" class="stat-value">0</div>
                    </div>
                </div>
                <div class="stat-item">
                    <span class="stat-icon">üìö</span>
                    <div>
                        <div class="stat-label">Completados</div>
                        <div id="scenarios-completed" class="stat-value">0</div>
                    </div>
                </div>
            </div>
            
            <div class="progress-container">
                <div class="xp-bar">
                    <div id="xp-fill" class="xp-fill" style="width: 0%"></div>
                </div>
                <div id="xp-text" class="progress-text">XP: 0 / 100</div>
            </div>
        </div>

        <!-- Interfaz Principal del Juego -->
        <div id="game-interface" class="game-interface">
            <!-- Contenido din√°mico del juego se genera aqu√≠ -->
        </div>
    </div>

    <!-- Scripts del Juego -->
    <script src="game.js"></script>
    <script>
        // Variables globales del juego
        let gameManager = null;
        let tutorialCompleted = false;
        let currentStep = 1;
        const totalSteps = 5;

        // Funci√≥n principal de inicializaci√≥n
        function initializeApp() {
            console.log('üéØ Inicializando Laboratorio ISO...');
            
            // Configurar tutorial
            setupTutorial();
            
            // Verificar si el tutorial ya fue completado
            if (localStorage.getItem('tutorial-completed') === 'true') {
                startGame();
            } else {
                showTutorial();
            }
        }

        // Configurar navegaci√≥n del tutorial
        function setupTutorial() {
            const prevBtn = document.getElementById('wizard-prev');
            const nextBtn = document.getElementById('wizard-next');
            const startBtn = document.getElementById('wizard-start');

            if (prevBtn) prevBtn.onclick = previousStep;
            if (nextBtn) nextBtn.onclick = nextStep;
            if (startBtn) startBtn.onclick = completeTutorial;

            updateTutorialStep();
        }

        // Navegar al paso anterior
        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                updateTutorialStep();
            }
        }

        // Navegar al siguiente paso
        function nextStep() {
            if (currentStep < totalSteps) {
                currentStep++;
                updateTutorialStep();
            }
        }

        // Actualizar la UI del tutorial
        function updateTutorialStep() {
            // Actualizar pasos activos
            const steps = document.querySelectorAll('.wizard-step');
            steps.forEach((step, index) => {
                step.classList.toggle('active', index === currentStep - 1);
            });

            // Actualizar indicadores
            const indicators = document.querySelectorAll('.indicator');
            indicators.forEach((indicator, index) => {
                indicator.classList.toggle('active', index < currentStep);
            });

            // Actualizar botones
            const prevBtn = document.getElementById('wizard-prev');
            const nextBtn = document.getElementById('wizard-next');
            const startBtn = document.getElementById('wizard-start');

            if (prevBtn) prevBtn.disabled = currentStep === 1;
            
            if (currentStep === totalSteps) {
                if (nextBtn) nextBtn.style.display = 'none';
                if (startBtn) startBtn.style.display = 'block';
            } else {
                if (nextBtn) nextBtn.style.display = 'block';
                if (startBtn) startBtn.style.display = 'none';
            }
        }

        // Completar tutorial y comenzar juego
        function completeTutorial() {
            localStorage.setItem('tutorial-completed', 'true');
            tutorialCompleted = true;
            startGame();
        }

        // Mostrar tutorial
        function showTutorial() {
            const tutorial = document.getElementById('tutorial-wizard');
            const gameApp = document.getElementById('game-app');
            
            if (tutorial) tutorial.style.display = 'flex';
            if (gameApp) gameApp.style.display = 'none';
        }

        // Iniciar el juego principal
        function startGame() {
            console.log('üéÆ Iniciando juego...');
            
            const tutorial = document.getElementById('tutorial-wizard');
            const gameApp = document.getElementById('game-app');
            
            if (tutorial) tutorial.style.display = 'none';
            if (gameApp) gameApp.style.display = 'block';
            
            // Inicializar el GameManager si existe
            if (typeof GameManager !== 'undefined' && !gameManager) {
                try {
                    gameManager = new GameManager();
                    gameManager.init();
                    console.log('‚úÖ GameManager inicializado correctamente');
                } catch (error) {
                    console.warn('‚ö†Ô∏è Error al inicializar GameManager:', error);
                    initializeSimpleGame();
                }
            } else {
                initializeSimpleGame();
            }
        }

        // Inicializar versi√≥n simple del juego si GameManager falla
        function initializeSimpleGame() {
            console.log('üéÆ Inicializando juego simple...');
            
            // Actualizar HUD con valores por defecto
            updateHUD(0, 1, 0, 0);
            
            // Crear interfaz b√°sica de escenarios
            const gameInterface = document.getElementById('game-interface');
            if (gameInterface) {
                gameInterface.innerHTML = createScenariosInterface();
            }
        }

        // Crear interfaz de selecci√≥n de escenarios
        function createScenariosInterface() {
            return `
                <div class="scenario-selection">
                    <h2>Selecciona tu Escenario de Aprendizaje</h2>
                    <div class="scenarios-grid">
                        <div class="scenario-card" onclick="playScenario('ecommerce')">
                            <div class="scenario-header">
                                <span class="scenario-icon">üõçÔ∏è</span>
                                <h3>E-commerce Platform</h3>
                                <span class="difficulty f√°cil">F√°cil</span>
                            </div>
                            <p class="scenario-desc">Desarrolla una plataforma de comercio electr√≥nico escalable aplicando est√°ndares ISO de usabilidad y calidad.</p>
                            <button class="scenario-btn">Comenzar Escenario</button>
                        </div>
                        
                        <div class="scenario-card" onclick="playScenario('hospital')">
                            <div class="scenario-header">
                                <span class="scenario-icon">üè•</span>
                                <h3>Sistema Hospitalario</h3>
                                <span class="difficulty intermedio">Intermedio</span>
                            </div>
                            <p class="scenario-desc">Gestiona el desarrollo de un sistema m√©dico cr√≠tico con estrictos requisitos de seguridad y confiabilidad.</p>
                            <button class="scenario-btn">Comenzar Escenario</button>
                        </div>
                        
                        <div class="scenario-card" onclick="playScenario('finance')">
                            <div class="scenario-header">
                                <span class="scenario-icon">üìä</span>
                                <h3>An√°lisis Financiero</h3>
                                <span class="difficulty avanzado">Avanzado</span>
                            </div>
                            <p class="scenario-desc">Desarrolla un sistema de trading de alta frecuencia con requisitos extremos de performance y precisi√≥n.</p>
                            <button class="scenario-btn">Comenzar Escenario</button>
                        </div>
                        
                        <div class="scenario-card" onclick="playScenario('social')">
                            <div class="scenario-header">
                                <span class="scenario-icon">üì±</span>
                                <h3>App M√≥vil Social</h3>
                                <span class="difficulty intermedio">Intermedio</span>
                            </div>
                            <p class="scenario-desc">Crea una aplicaci√≥n social competitiva con enfoque en experiencia de usuario y escalabilidad masiva.</p>
                            <button class="scenario-btn">Comenzar Escenario</button>
                        </div>
                    </div>
                </div>
                
                <div class="challenges-section">
                    <h2>Desaf√≠os R√°pidos</h2>
                    <div class="challenges-grid">
                        <div class="challenge-card" onclick="startQuiz()">
                            <h3>Quiz ISO 25010</h3>
                            <p>Responde preguntas sobre las caracter√≠sticas de calidad del software seg√∫n el est√°ndar ISO 25010.</p>
                            <div class="challenge-meta">
                                <span class="challenge-type">Quiz</span>
                                <span class="time-limit">‚è±Ô∏è 3 min</span>
                            </div>
                            <button class="challenge-btn">Comenzar Quiz</button>
                        </div>
                        
                        <div class="challenge-card" onclick="startRequirementsChallenge()">
                            <h3>Ingenier√≠a de Requisitos</h3>
                            <p>Dise√±a requisitos siguiendo el est√°ndar ISO 29148 para un proyecto real.</p>
                            <div class="challenge-meta">
                                <span class="challenge-type">Construcci√≥n</span>
                                <span class="time-limit">‚è±Ô∏è 5 min</span>
                            </div>
                            <button class="challenge-btn">Comenzar Desaf√≠o</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Actualizar HUD del jugador
        function updateHUD(score, level, achievements, completed) {
            const scoreEl = document.getElementById('player-score');
            const levelEl = document.getElementById('player-level');
            const achievementsEl = document.getElementById('player-achievements');
            const completedEl = document.getElementById('scenarios-completed');
            const xpFill = document.getElementById('xp-fill');
            const xpText = document.getElementById('xp-text');

            if (scoreEl) scoreEl.textContent = score;
            if (levelEl) levelEl.textContent = level;
            if (achievementsEl) achievementsEl.textContent = achievements;
            if (completedEl) completedEl.textContent = completed;
            
            // Calcular XP para el siguiente nivel
            const xpNeeded = level * 100;
            const currentXP = score % xpNeeded;
            const xpPercent = (currentXP / xpNeeded) * 100;
            
            if (xpFill) xpFill.style.width = xpPercent + '%';
            if (xpText) xpText.textContent = `XP: ${currentXP} / ${xpNeeded}`;
        }

        // Funciones de juego
        function playScenario(scenarioId) {
            alert(`üéÆ Comenzando escenario: ${scenarioId}\n\n¬°Pr√≥ximamente disponible con mec√°nicas completas de decisi√≥n y puntuaci√≥n!`);
            
            // Simular progreso
            const currentScore = parseInt(document.getElementById('player-score')?.textContent || '0');
            const newScore = currentScore + 50;
            const currentLevel = Math.floor(newScore / 100) + 1;
            const currentAchievements = parseInt(document.getElementById('player-achievements')?.textContent || '0') + 1;
            const currentCompleted = parseInt(document.getElementById('scenarios-completed')?.textContent || '0') + 1;
            
            updateHUD(newScore, currentLevel, currentAchievements, currentCompleted);
            
            // Guardar progreso
            localStorage.setItem('iso-game-progress', JSON.stringify({
                score: newScore,
                level: currentLevel,
                achievements: currentAchievements,
                completed: currentCompleted
            }));
        }

        function startQuiz() {
            alert('üß† Quiz ISO 25010 iniciando...\n\n¬°Sistema de quiz interactivo pr√≥ximamente!');
        }

        function startRequirementsChallenge() {
            alert('üìã Desaf√≠o de Ingenier√≠a de Requisitos...\n\n¬°Constructor de requisitos pr√≥ximamente!');
        }

        // Cargar progreso guardado
        function loadProgress() {
            const saved = localStorage.getItem('iso-game-progress');
            if (saved) {
                try {
                    const progress = JSON.parse(saved);
                    updateHUD(progress.score || 0, progress.level || 1, progress.achievements || 0, progress.completed || 0);
                } catch (error) {
                    console.warn('Error cargando progreso guardado:', error);
                }
            }
        }

        // Inicializar cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üìÑ DOM cargado, inicializando aplicaci√≥n...');
            initializeApp();
            loadProgress();
        });

        // Mensaje de √©xito en la consola
        window.addEventListener('load', function() {
            console.log('‚úÖ Laboratorio ISO cargado completamente!');
            console.log('üéØ Listo para jugar y aprender est√°ndares ISO');
        });
    </script>
</body>
</html>