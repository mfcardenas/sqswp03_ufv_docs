<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè• MedCore Hospital System - Simulador Interactivo de Proyecto ISO</title>
    <link rel="stylesheet" href="medcore-enhanced-styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè•</text></svg>">
</head>
<body>
    <!-- Tutorial Interactivo -->
    <div id="tutorial-overlay" class="tutorial-overlay">
        <div class="tutorial-container">
            <div class="tutorial-header">
                <h1>üéì Tutorial Interactivo</h1>
                <button class="skip-btn" onclick="skipTutorial()">Saltar Tutorial</button>
            </div>
            
            <div class="tutorial-content">
                <div class="tutorial-step" id="tutorial-step-1">
                    <h2>Bienvenido al Simulador MedCore</h2>
                    <p>Este no es un juego simple de clics. Aqu√≠ tomar√°s decisiones reales de ingenier√≠a de software aplicando est√°ndares ISO en un entorno hospitalario cr√≠tico.</p>
                    <div class="tutorial-highlight">
                        <strong>üéØ Tu objetivo:</strong> Liderar el desarrollo de un sistema de gesti√≥n hospitalaria completo, tomando decisiones t√©cnicas fundamentadas y gestionando recursos limitados.
                    </div>
                    <button class="tutorial-btn" onclick="nextTutorialStep(2)">Continuar</button>
                </div>
                
                <div class="tutorial-step" id="tutorial-step-2" style="display: none;">
                    <h2>Sistema de Decisiones Complejas</h2>
                    <p>Cada decisi√≥n tiene m√∫ltiples opciones con diferentes consecuencias:</p>
                    <ul>
                        <li><strong>Impacto t√©cnico</strong> - Afecta la calidad del software</li>
                        <li><strong>Costos</strong> - Modifica tu presupuesto disponible</li>
                        <li><strong>Tiempo</strong> - Influye en los plazos de entrega</li>
                        <li><strong>Stakeholders</strong> - Cambia la satisfacci√≥n de usuarios clave</li>
                    </ul>
                    <div class="tutorial-warning">
                        ‚ö†Ô∏è <strong>Cuidado:</strong> Las decisiones err√≥neas pueden llevar al fracaso del proyecto
                    </div>
                    <button class="tutorial-btn" onclick="nextTutorialStep(3)">Continuar</button>
                </div>
                
                <div class="tutorial-step" id="tutorial-step-3" style="display: none;">
                    <h2>Aplicaci√≥n de Est√°ndares ISO</h2>
                    <p>Aplicar√°s est√°ndares reales de la industria:</p>
                    <div class="standards-preview">
                        <div class="standard-item">
                            <h4>üìã ISO 29148</h4>
                            <p>Gesti√≥n de Requisitos de Sistemas</p>
                        </div>
                        <div class="standard-item">
                            <h4>‚ö° ISO 25010</h4>
                            <p>Caracter√≠sticas de Calidad del Software</p>
                        </div>
                        <div class="standard-item">
                            <h4>üîÑ ISO 12207</h4>
                            <p>Procesos de Ciclo de Vida del Software</p>
                        </div>
                        <div class="standard-item">
                            <h4>üë• ISO 9241</h4>
                            <p>Ergonom√≠a de Sistemas Interactivos</p>
                        </div>
                    </div>
                    <button class="tutorial-btn" onclick="startRealGame()">¬°Comenzar Proyecto!</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Interfaz Principal del Juego -->
    <div id="game-interface" class="game-interface" style="display: none;">
        <!-- Header del Proyecto -->
        <header class="project-header">
            <div class="hospital-info">
                <div class="hospital-logo">üè•</div>
                <div class="hospital-details">
                    <h1>Hospital San Rafael</h1>
                    <p>Proyecto MedCore - Sistema de Gesti√≥n Hospitalaria</p>
                </div>
            </div>
            
            <div class="project-status">
                <div class="status-item">
                    <span class="status-label">Fase</span>
                    <span class="status-value" id="current-phase">1/4</span>
                </div>
                <div class="status-item critical">
                    <span class="status-label">Presupuesto</span>
                    <span class="status-value" id="budget-display">‚Ç¨2,500,000</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Tiempo</span>
                    <span class="status-value" id="time-remaining">18 meses</span>
                </div>
            </div>
        </header>

        <!-- Dashboard de M√©tricas -->
        <section class="metrics-dashboard">
            <div class="dashboard-header">
                <h2>üìä Estado del Proyecto</h2>
                <div class="overall-health" id="project-health">
                    <span class="health-indicator good"></span>
                    <span>Proyecto Saludable</span>
                </div>
            </div>
            
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-name">Funcionalidad</span>
                        <span class="metric-score" id="functionality-score">65</span>
                    </div>
                    <div class="metric-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="functionality-progress" style="width: 65%"></div>
                        </div>
                    </div>
                    <div class="metric-description">Completitud de caracter√≠sticas del sistema</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-name">Usabilidad</span>
                        <span class="metric-score" id="usability-score">60</span>
                    </div>
                    <div class="metric-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="usability-progress" style="width: 60%"></div>
                        </div>
                    </div>
                    <div class="metric-description">Facilidad de uso para el personal m√©dico</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-name">Seguridad</span>
                        <span class="metric-score" id="security-score">70</span>
                    </div>
                    <div class="metric-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="security-progress" style="width: 70%"></div>
                        </div>
                    </div>
                    <div class="metric-description">Protecci√≥n de datos m√©dicos sensibles</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-name">Rendimiento</span>
                        <span class="metric-score" id="performance-score">55</span>
                    </div>
                    <div class="metric-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="performance-progress" style="width: 55%"></div>
                        </div>
                    </div>
                    <div class="metric-description">Velocidad y capacidad del sistema</div>
                </div>
            </div>
        </section>

        <!-- Satisfacci√≥n de Stakeholders -->
        <section class="stakeholders-section">
            <h2>üë• Satisfacci√≥n de Stakeholders</h2>
            <div class="stakeholders-grid">
                <div class="stakeholder-card">
                    <div class="stakeholder-avatar">üë©‚Äç‚öïÔ∏è</div>
                    <div class="stakeholder-info">
                        <h3>Dra. Mar√≠a Gonz√°lez</h3>
                        <p>Directora M√©dica</p>
                        <div class="satisfaction-meter">
                            <div class="satisfaction-fill" id="maria-satisfaction" style="width: 70%"></div>
                        </div>
                        <div class="satisfaction-score">70%</div>
                    </div>
                    <div class="stakeholder-concerns" id="maria-concerns">
                        <p>Preocupada por la integraci√≥n con sistemas cl√≠nicos existentes</p>
                    </div>
                </div>
                
                <div class="stakeholder-card">
                    <div class="stakeholder-avatar">üë®‚Äçüíº</div>
                    <div class="stakeholder-info">
                        <h3>Ing. Carlos M√©ndez</h3>
                        <p>CTO Hospital</p>
                        <div class="satisfaction-meter">
                            <div class="satisfaction-fill" id="carlos-satisfaction" style="width: 65%"></div>
                        </div>
                        <div class="satisfaction-score">65%</div>
                    </div>
                    <div class="stakeholder-concerns" id="carlos-concerns">
                        <p>Enfocado en la seguridad y escalabilidad del sistema</p>
                    </div>
                </div>
                
                <div class="stakeholder-card">
                    <div class="stakeholder-avatar">üë©‚Äçüíº</div>
                    <div class="stakeholder-info">
                        <h3>Lic. Ana Ruiz</h3>
                        <p>Directora Administrativa</p>
                        <div class="satisfaction-meter">
                            <div class="satisfaction-fill" id="ana-satisfaction" style="width: 60%"></div>
                        </div>
                        <div class="satisfaction-score">60%</div>
                    </div>
                    <div class="stakeholder-concerns" id="ana-concerns">
                        <p>Preocupada por los costos y el impacto en la operaci√≥n diaria</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- √Årea de Contenido Principal -->
        <main class="main-content" id="main-content">
            <!-- El contenido se carga din√°micamente aqu√≠ -->
        </main>

        <!-- Panel de Notificaciones Movible -->
        <aside class="notifications-panel draggable" id="notifications-panel">
            <div class="notifications-header" id="notifications-header">
                <h3>üîî Notificaciones del Proyecto</h3>
                <div class="panel-controls">
                    <button class="help-btn" onclick="showNotificationsHelp()" title="Ayuda sobre notificaciones">?</button>
                    <button class="minimize-btn" onclick="toggleNotificationsPanel()" title="Minimizar/Maximizar">‚àí</button>
                    <button class="move-btn" title="Arrastrar para mover">‚ãÆ‚ãÆ</button>
                </div>
            </div>
            <div class="notifications-list" id="notifications-list">
                <!-- Las notificaciones se a√±aden din√°micamente -->
            </div>
        </aside>
    </div>

    <!-- Modal para Decisiones Complejas -->
    <div id="decision-modal" class="modal" style="display: none;">
        <div class="modal-content decision-modal">
            <div class="modal-header">
                <h2 id="decision-title">Tomar Decisi√≥n</h2>
                <button class="close-btn" onclick="closeDecisionModal()">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="decision-context" id="decision-context">
                    <!-- Contexto de la decisi√≥n -->
                </div>
                
                <div class="decision-options" id="decision-options">
                    <!-- Opciones de decisi√≥n se cargan aqu√≠ -->
                </div>
                
                <div class="decision-analysis" id="decision-analysis">
                    <h4>üìä An√°lisis de Impacto Previsto</h4>
                    <div class="impact-preview" id="impact-preview">
                        <!-- Preview del impacto se muestra aqu√≠ -->
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn secondary" onclick="closeDecisionModal()">Cancelar</button>
                <button class="btn primary" id="confirm-decision" onclick="executeDecision()" disabled>Confirmar Decisi√≥n</button>
            </div>
        </div>
    </div>

    <!-- Modal para Selecci√≥n de Requisitos -->
    <div id="requirements-modal" class="modal" style="display: none;">
        <div class="modal-content requirements-modal">
            <div class="modal-header">
                <h2>üìã Cat√°logo de Requisitos del Sistema</h2>
                <button class="close-btn" onclick="closeRequirementsModal()">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="requirements-instructions">
                    <p>Selecciona los requisitos m√°s importantes para el Hospital San Rafael. <strong>Solo puedes elegir 8 de 15</strong> debido a restricciones de tiempo y presupuesto.</p>
                    <div class="selection-counter">
                        Seleccionados: <span id="selected-count">0</span>/8
                    </div>
                </div>
                
                <div class="requirements-categories">
                    <div class="category-tab active" data-category="functional" onclick="switchCategory('functional')">
                        Funcionales
                    </div>
                    <div class="category-tab" data-category="quality" onclick="switchCategory('quality')">
                        Calidad
                    </div>
                    <div class="category-tab" data-category="constraints" onclick="switchCategory('constraints')">
                        Restricciones
                    </div>
                </div>
                
                <div class="requirements-list" id="requirements-list">
                    <!-- Lista de requisitos se carga aqu√≠ -->
                </div>
            </div>
            
            <div class="modal-footer">
                <div class="requirements-summary">
                    <span>Impacto estimado en presupuesto: <strong id="budget-impact">‚Ç¨0</strong></span>
                </div>
                <button class="btn secondary" onclick="closeRequirementsModal()">Cancelar</button>
                <button class="btn primary" id="confirm-requirements" onclick="confirmRequirements()" disabled>Confirmar Selecci√≥n</button>
            </div>
        </div>
    </div>

    <!-- Modal de Feedback Educativo -->
    <div id="feedback-modal" class="modal" style="display: none;">
        <div class="modal-content feedback-modal">
            <div class="modal-header">
                <h2 id="feedback-title">üìö Feedback Educativo</h2>
                <button class="close-btn" onclick="closeFeedbackModal()">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="feedback-content" id="feedback-content">
                    <!-- Contenido educativo se carga aqu√≠ -->
                </div>
                
                <div class="iso-standards-applied" id="iso-standards-applied">
                    <!-- Est√°ndares ISO aplicados -->
                </div>
                
                <div class="lessons-learned" id="lessons-learned">
                    <!-- Lecciones aprendidas -->
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn primary" onclick="closeFeedbackModal()">Entendido</button>
            </div>
        </div>
    </div>

    <script>
        // ==========================================
        // FUNCIONES DEL TUTORIAL (DISPONIBLES INMEDIATAMENTE)
        // ==========================================
        
        // Funci√≥n para avanzar pasos del tutorial
        function nextTutorialStep(step) {
            console.log('nextTutorialStep llamada con step:', step);
            try {
                document.querySelectorAll('.tutorial-step').forEach(s => s.style.display = 'none');
                const targetStep = document.getElementById(`tutorial-step-${step}`);
                if (targetStep) {
                    targetStep.style.display = 'block';
                    console.log('‚úÖ Mostrando step:', step);
                } else {
                    console.error('‚ùå No se encontr√≥ tutorial-step-' + step);
                }
            } catch (error) {
                console.error('‚ùå Error en nextTutorialStep:', error);
            }
        }

        // Funci√≥n para saltar tutorial
        function skipTutorial() {
            console.log('üöÄ skipTutorial llamada');
            try {
                document.getElementById('tutorial-overlay').style.display = 'none';
                document.getElementById('game-interface').style.display = 'block';
                if (typeof loadPhaseContent === 'function') {
                    loadPhaseContent();
                } else {
                    console.warn('‚ö†Ô∏è loadPhaseContent no est√° definida a√∫n');
                }
            } catch (error) {
                console.error('‚ùå Error en skipTutorial:', error);
            }
        }

        // Funci√≥n para iniciar el juego real
        function startRealGame() {
            console.log('üéÆ startRealGame llamada');
            try {
                document.getElementById('tutorial-overlay').style.display = 'none';
                document.getElementById('game-interface').style.display = 'block';
                if (typeof addNotification === 'function') {
                    addNotification('¬°Proyecto MedCore iniciado! Fase 1: An√°lisis de Requisitos', 'success');
                }
                if (typeof loadPhaseContent === 'function') {
                    loadPhaseContent();
                } else {
                    console.warn('‚ö†Ô∏è loadPhaseContent no est√° definida a√∫n');
                }
            } catch (error) {
                console.error('‚ùå Error en startRealGame:', error);
            }
        }

        // Hacer funciones disponibles globalmente
        window.nextTutorialStep = nextTutorialStep;
        window.skipTutorial = skipTutorial;
        window.startRealGame = startRealGame;

        console.log('‚úÖ Funciones del tutorial cargadas');

        // ==========================================
        // ESTADO DEL JUEGO Y CONFIGURACI√ìN
        // ==========================================
        
        // Estado del juego mejorado
        let gameState = {
            currentPhase: 1,
            totalPhases: 4,
            budget: 2500000, // ‚Ç¨2.5M
            timeRemaining: 18, // meses
            metrics: {
                functionality: 65,
                usability: 60,
                security: 70,
                performance: 55,
                reliability: 68,
                efficiency: 62,
                maintainability: 58,
                portability: 50
            },
            stakeholders: {
                maria: { satisfaction: 70, concerns: ['integration', 'clinical_workflow'] },
                carlos: { satisfaction: 65, concerns: ['security', 'scalability'] },
                ana: { satisfaction: 60, concerns: ['cost', 'operational_impact'] }
            },
            selectedRequirements: [],
            decisionsHistory: [],
            notifications: [],
            currentChallenge: null,
            score: 0,
            achievements: []
        };

        // Cat√°logo de requisitos del sistema (expandido con distractores)
        const requirementsCatalog = {
            functional: [
                {
                    id: 'patient_mgmt',
                    title: 'Gesti√≥n Integral de Pacientes',
                    description: 'Sistema completo para registro, seguimiento y gesti√≥n de historiales de pacientes seg√∫n ISO 29148',
                    cost: 150000,
                    impact: { functionality: 25, usability: 15 },
                    complexity: 'high',
                    iso_standard: 'ISO 29148 - Secci√≥n 6.3 (Especificaci√≥n de Requisitos)',
                    iso_benefit: 'Requisitos trazables y verificables para gesti√≥n de pacientes'
                },
                {
                    id: 'clinical_history',
                    title: 'Historial Cl√≠nico Electr√≥nico Avanzado',
                    description: 'Digitalizaci√≥n completa con firma digital y acceso controlado seg√∫n ISO 27001',
                    cost: 200000,
                    impact: { functionality: 30, security: 20 },
                    complexity: 'high',
                    iso_standard: 'ISO 25010 - Caracter√≠stica Funcionalidad',
                    iso_benefit: 'Completitud funcional y correcci√≥n funcional'
                },
                {
                    id: 'pharmacy_mgmt',
                    title: 'Sistema de Farmacia Robotizada',
                    description: 'Control automatizado de inventario con robots dispensadores',
                    cost: 120000,
                    impact: { functionality: 20, reliability: 15 },
                    complexity: 'medium',
                    iso_standard: 'ISO 12207 - Proceso de Implementaci√≥n',
                    iso_benefit: 'Procesos sistematizados de implementaci√≥n'
                },
                {
                    id: 'lab_integration',
                    title: 'Integraci√≥n Total de Laboratorio',
                    description: 'Conectividad bidireccional con todos los equipos de laboratorio',
                    cost: 180000,
                    impact: { functionality: 22, performance: 18 },
                    complexity: 'high',
                    iso_standard: 'ISO 12207 - Integraci√≥n del Sistema',
                    iso_benefit: 'Estrategias de integraci√≥n sistem√°ticas'
                },
                {
                    id: 'appointment_system',
                    title: 'Sistema de Citas Inteligente',
                    description: 'IA para optimizaci√≥n autom√°tica de horarios m√©dicos',
                    cost: 80000,
                    impact: { functionality: 15, usability: 20 },
                    complexity: 'medium',
                    iso_standard: 'ISO 9241-11 - Usabilidad en Contexto',
                    iso_benefit: 'Efectividad, eficiencia y satisfacci√≥n del usuario'
                },
                {
                    id: 'blockchain_records',
                    title: 'Blockchain para Historiales M√©dicos',
                    description: 'Sistema distribuido con blockchain para inmutabilidad de datos',
                    cost: 300000,
                    impact: { functionality: 10, security: 35 },
                    complexity: 'high',
                    iso_standard: 'ISO 27001',
                    iso_benefit: 'Tecnolog√≠a emergente con alta seguridad'
                },
                {
                    id: 'vr_surgery_planning',
                    title: 'Realidad Virtual para Planificaci√≥n Quir√∫rgica',
                    description: 'Entorno VR inmersivo para planificaci√≥n de cirug√≠as complejas',
                    cost: 250000,
                    impact: { functionality: 12, usability: -5 },
                    complexity: 'high',
                    iso_standard: 'ISO 9241',
                    iso_benefit: 'Mejora la experiencia visual y planificaci√≥n m√©dica'
                }
            ],
            quality: [
                {
                    id: 'data_security',
                    title: 'Seguridad Multicapa de Datos M√©dicos',
                    description: 'Implementaci√≥n completa de ISO 27001 con encriptaci√≥n AES-256',
                    cost: 160000,
                    impact: { security: 35, reliability: 20 },
                    complexity: 'high',
                    iso_standard: 'ISO 27001 - Anexo A.9 (Control de Acceso)',
                    iso_benefit: 'Gesti√≥n sistem√°tica de la seguridad de la informaci√≥n'
                },
                {
                    id: 'performance_optimization',
                    title: 'Optimizaci√≥n de Rendimiento Cr√≠tico',
                    description: 'Garant√≠a de respuesta <1s seg√∫n ISO 25010 para emergencias',
                    cost: 100000,
                    impact: { performance: 30, usability: 15 },
                    complexity: 'medium',
                    iso_standard: 'ISO 25010 - Eficiencia de Desempe√±o',
                    iso_benefit: 'Comportamiento temporal y utilizaci√≥n de recursos'
                },
                {
                    id: 'backup_recovery',
                    title: 'Sistema de Respaldo Geogr√°ficamente Distribuido',
                    description: 'RPO=0 y RTO<15min con r√©plica en tiempo real',
                    cost: 90000,
                    impact: { reliability: 25, security: 15 },
                    complexity: 'medium',
                    iso_standard: 'ISO 25010 - Fiabilidad (Disponibilidad)',
                    iso_benefit: 'Disponibilidad operacional y recuperabilidad'
                },
                {
                    id: 'user_training',
                    title: 'Programa de Capacitaci√≥n ISO 9241',
                    description: 'Entrenamiento basado en principios de dise√±o centrado en usuario',
                    cost: 130000,
                    impact: { usability: 30, efficiency: 20 },
                    complexity: 'medium',
                    iso_standard: 'ISO 9241-210 - Dise√±o Centrado en el Usuario',
                    iso_benefit: 'Proceso iterativo de dise√±o con participaci√≥n del usuario'
                },
                {
                    id: 'mobile_access',
                    title: 'App M√≥vil con Biometr√≠a Avanzada',
                    description: 'Aplicaci√≥n nativa con reconocimiento facial y dactilar',
                    cost: 110000,
                    impact: { usability: 25, portability: 35 },
                    complexity: 'medium',
                    iso_standard: 'ISO 25010 - Portabilidad (Adaptabilidad)',
                    iso_benefit: 'Capacidad de adaptaci√≥n a diferentes entornos'
                },
                {
                    id: 'ai_predictive_analytics',
                    title: 'IA Predictiva para Diagn√≥sticos',
                    description: 'Machine learning para predicci√≥n de enfermedades',
                    cost: 400000,
                    impact: { functionality: 35, reliability: -10 },
                    complexity: 'high',
                    iso_standard: 'ISO 25010',
                    iso_benefit: 'Mejora la precisi√≥n diagn√≥stica mediante IA'
                },
                {
                    id: 'quantum_encryption',
                    title: 'Encriptaci√≥n Cu√°ntica Experimental',
                    description: 'Seguridad cu√°ntica te√≥ricamente inquebrantable',
                    cost: 500000,
                    impact: { security: 50, maintainability: -25 },
                    complexity: 'high',
                    iso_standard: 'ISO 27001',
                    iso_benefit: 'M√°xima seguridad te√≥rica disponible'
                },
                {
                    id: 'gamification_ui',
                    title: 'Gamificaci√≥n de Interfaces M√©dicas',
                    description: 'Elementos de juego para motivar al personal m√©dico',
                    cost: 75000,
                    impact: { usability: 15, efficiency: -5 },
                    complexity: 'low',
                    iso_standard: 'ISO 9241',
                    iso_benefit: 'Mejora la motivaci√≥n y adopci√≥n del sistema'
                }
            ],
            constraints: [
                {
                    id: 'regulatory_compliance',
                    title: 'Cumplimiento Regulatorio Exhaustivo',
                    description: 'Adherencia total a GDPR, LOPD, FDA 21 CFR Part 11 y normativas sanitarias',
                    cost: 140000,
                    impact: { security: 20, reliability: 15 },
                    complexity: 'high',
                    iso_standard: 'ISO 25010 - Compatibilidad (Conformidad)',
                    iso_benefit: 'Cumplimiento de est√°ndares y convenciones'
                },
                {
                    id: 'system_integration',
                    title: 'Integraci√≥n con Sistemas Legacy',
                    description: 'APIs RESTful y FHIR para conectividad total seg√∫n ISO 12207',
                    cost: 170000,
                    impact: { functionality: 15, maintainability: 25 },
                    complexity: 'high',
                    iso_standard: 'ISO 12207 - Proceso de Integraci√≥n del Sistema',
                    iso_benefit: 'Metodolog√≠a sistem√°tica para integraci√≥n de componentes'
                },
                {
                    id: 'scalability_planning',
                    title: 'Arquitectura Escalable Horizontal',
                    description: 'Dise√±o cloud-native para crecimiento exponencial del hospital',
                    cost: 95000,
                    impact: { performance: 20, maintainability: 20 },
                    complexity: 'medium',
                    iso_standard: 'ISO 25010 - Eficiencia de Desempe√±o',
                    iso_benefit: 'Capacidad de escalar recursos seg√∫n demanda'
                },
                {
                    id: 'disaster_recovery',
                    title: 'Plan de Continuidad de Negocio ISO 22301',
                    description: 'Recuperaci√≥n ante desastres con certificaci√≥n internacional',
                    cost: 125000,
                    impact: { reliability: 30, security: 10 },
                    complexity: 'high',
                    iso_standard: 'ISO 22301 - Gesti√≥n de Continuidad del Negocio',
                    iso_benefit: 'Marco sistem√°tico para resiliencia organizacional'
                },
                {
                    id: 'multi_language',
                    title: 'Localizaci√≥n Completa Multiidioma',
                    description: 'Soporte para 12 idiomas con localizaci√≥n cultural',
                    cost: 70000,
                    impact: { usability: 15, portability: 20 },
                    complexity: 'low',
                    iso_standard: 'ISO 9241-161 - Elementos de Interfaz Gr√°fica',
                    iso_benefit: 'Consideraciones culturales en el dise√±o de interfaces'
                },
                {
                    id: 'carbon_neutral',
                    title: 'Infraestructura Carbon-Neutral',
                    description: 'Servidores alimentados 100% por energ√≠a renovable',
                    cost: 200000,
                    impact: { efficiency: 10, maintainability: -5 },
                    complexity: 'high',
                    iso_standard: 'ISO 14001',
                    iso_benefit: 'Est√°ndar ambiental para sostenibilidad'
                },
                {
                    id: 'social_media_integration',
                    title: 'Integraci√≥n con Redes Sociales',
                    description: 'Compartir logros m√©dicos en redes sociales del hospital',
                    cost: 45000,
                    impact: { functionality: 5, security: -15 },
                    complexity: 'low',
                    iso_standard: 'ISO 27001',
                    iso_benefit: 'Marco para gesti√≥n de seguridad de la informaci√≥n'
                },
                {
                    id: 'cryptocurrency_payments',
                    title: 'Pagos con Criptomonedas',
                    description: 'Aceptar Bitcoin y Ethereum para pagos m√©dicos',
                    cost: 80000,
                    impact: { portability: 10, security: -20 },
                    complexity: 'medium',
                    iso_standard: 'ISO 27001',
                    iso_benefit: 'Gesti√≥n de riesgos de seguridad financiera'
                }
            ]
        };

        // Decisiones complejas por fase
        const phaseDecisions = {
            1: [
                {
                    id: 'requirements_methodology',
                    title: 'Metodolog√≠a de Recolecci√≥n de Requisitos',
                    context: 'Seg√∫n ISO 29148, la recolecci√≥n de requisitos debe ser sistem√°tica y verificable. El Hospital San Rafael tiene procesos complejos y diversos stakeholders con necesidades conflictivas.',
                    isoReference: 'ISO 29148:2018 - Secci√≥n 6.3: Los requisitos deben ser necesarios, no ambiguos, consistentes, completos, singulares, factibles y verificables.',
                    options: [
                        {
                            id: 'interviews_focus',
                            title: 'Entrevistas Estructuradas + Grupos Focales (ISO 29148)',
                            description: 'Enfoque tradicional con entrevistas individuales y sesiones grupales sistem√°ticas',
                            cost: 30000,
                            time: 2,
                            impact: {
                                functionality: 15,
                                usability: 10,
                                maria: 15,
                                ana: 5
                            },
                            risks: ['Puede ser lento', 'Informaci√≥n fragmentada'],
                            benefits: ['Alta precisi√≥n seg√∫n ISO 29148', 'Detecci√≥n de conflictos'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'shadowing_observation',
                            title: 'Job Shadowing + Observaci√≥n Directa',
                            description: 'Observar directamente los flujos de trabajo m√©dicos reales',
                            cost: 15000,
                            time: 3,
                            impact: {
                                functionality: 20,
                                usability: 18,
                                carlos: -5,
                                maria: 20
                            },
                            risks: ['Interrumpe operaciones', 'Datos sensibles expuestos'],
                            benefits: ['Requisitos reales', 'Detecta procesos ocultos'],
                            isoCompliance: 'medium'
                        },
                        {
                            id: 'workshops_prototyping',
                            title: 'Workshops Colaborativos + Prototipado R√°pido',
                            description: 'Sesiones intensivas de dise√±o conjunto con prototipos validables',
                            cost: 45000,
                            time: 4,
                            impact: {
                                functionality: 12,
                                usability: 25,
                                maria: 10,
                                carlos: 15,
                                ana: -10
                            },
                            risks: ['Alto costo', 'Expectativas no realistas'],
                            benefits: ['Buy-in stakeholders', 'Validaci√≥n temprana ISO 29148'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'ai_requirements_analysis',
                            title: 'An√°lisis de Requisitos con IA',
                            description: 'Usar inteligencia artificial para extraer requisitos autom√°ticamente',
                            cost: 80000,
                            time: 1,
                            impact: {
                                functionality: 5,
                                usability: -10,
                                carlos: -15,
                                maria: -20
                            },
                            risks: ['IA no comprende contexto m√©dico', 'Requisitos incorrectos'],
                            benefits: ['Velocidad aparente'],
                            isoCompliance: 'none'
                        },
                        {
                            id: 'crowdsourcing_requirements',
                            title: 'Crowdsourcing con Personal Externo',
                            description: 'Obtener requisitos de consultores externos sin experiencia hospitalaria',
                            cost: 25000,
                            time: 1,
                            impact: {
                                functionality: -5,
                                security: -15,
                                maria: -25,
                                carlos: -20
                            },
                            risks: ['Falta contexto m√©dico', 'Requisitos irrelevantes'],
                            benefits: ['Costo bajo inicial'],
                            isoCompliance: 'none'
                        }
                    ]
                },
                {
                    id: 'quality_approach',
                    title: 'Estrategia de Aseguramiento de Calidad',
                    context: 'Los sistemas hospitalarios requieren la m√°xima calidad y fiabilidad. Un error puede tener consecuencias graves. Debes definir c√≥mo garantizar la calidad del sistema seg√∫n ISO 25010.',
                    options: [
                        {
                            id: 'traditional_testing',
                            title: 'Testing Tradicional Exhaustivo',
                            description: 'Pruebas manuales y automatizadas en fases separadas',
                            cost: 80000,
                            time: 3,
                            impact: {
                                reliability: 25,
                                security: 15,
                                carlos: 20,
                                ana: -15
                            },
                            risks: ['Detecci√≥n tard√≠a de errores', 'Alto costo de correcci√≥n'],
                            benefits: ['Probado y confiable', 'Documentaci√≥n completa']
                        },
                        {
                            id: 'continuous_qa',
                            title: 'Calidad Continua (DevOps)',
                            description: 'Integraci√≥n continua con pruebas autom√°ticas',
                            cost: 60000,
                            time: 2,
                            impact: {
                                reliability: 20,
                                maintainability: 25,
                                performance: 15,
                                carlos: 25,
                                maria: -5
                            },
                            risks: ['Curva de aprendizaje', 'Dependencia de herramientas'],
                            benefits: ['Detecci√≥n temprana', 'Menores costos de correcci√≥n']
                        },
                        {
                            id: 'risk_based_testing',
                            title: 'Testing Basado en Riesgos',
                            description: 'Foco en √°reas cr√≠ticas seg√∫n an√°lisis de riesgos m√©dicos',
                            cost: 70000,
                            time: 2,
                            impact: {
                                reliability: 30,
                                security: 20,
                                maria: 25,
                                carlos: 15
                            },
                            risks: ['√Åreas no cr√≠ticas menos probadas'],
                            benefits: ['Optimizaci√≥n de recursos', 'Foco en lo importante']
                        }
                    ]
                }
            ],
            2: [
                {
                    id: 'architecture_pattern',
                    title: 'Patr√≥n de Arquitectura del Sistema',
                    context: 'Debes decidir la arquitectura fundamental que soportar√° todo el sistema MedCore. Esta decisi√≥n afectar√° la escalabilidad, mantenimiento y costos futuros seg√∫n ISO 25010.',
                    isoReference: 'ISO 25010:2011 - Calidad del software que define arquitectura como factor cr√≠tico para mantenibilidad y escalabilidad.',
                    options: [
                        {
                            id: 'monolithic',
                            title: 'Arquitectura Monol√≠tica',
                            description: 'Sistema √∫nico integrado con base de datos centralizada',
                            cost: 50000,
                            time: 1,
                            impact: {
                                performance: 20,
                                maintainability: -10,
                                portability: -15,
                                carlos: -10,
                                ana: 15
                            },
                            risks: ['Dificultad de escalado', 'Puntos √∫nicos de fallo'],
                            benefits: ['Simplicidad inicial', 'Menor complejidad operacional'],
                            isoCompliance: 'medium'
                        },
                        {
                            id: 'microservices',
                            title: 'Arquitectura de Microservicios',
                            description: 'Servicios independientes con comunicaci√≥n API seg√∫n ISO 25010',
                            cost: 120000,
                            time: 4,
                            impact: {
                                scalability: 30,
                                maintainability: 25,
                                performance: -5,
                                carlos: 30,
                                ana: -20
                            },
                            risks: ['Complejidad operacional', 'Latencia de red'],
                            benefits: ['Escalabilidad independiente', 'Tecnolog√≠as diversas'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'modular_monolith',
                            title: 'Monolito Modular',
                            description: 'Arquitectura modular con posibilidad de separaci√≥n futura',
                            cost: 80000,
                            time: 2,
                            impact: {
                                maintainability: 20,
                                portability: 15,
                                carlos: 15,
                                maria: 10,
                                ana: 5
                            },
                            risks: ['Complejidad de modularizaci√≥n'],
                            benefits: ['Flexibilidad futura', 'Balance complejidad-beneficio'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'blockchain_architecture',
                            title: 'Arquitectura Blockchain Distribuida',
                            description: 'Sistema completamente descentralizado con blockchain para cada transacci√≥n m√©dica',
                            cost: 500000,
                            time: 8,
                            impact: {
                                performance: -30,
                                maintainability: -25,
                                security: 10,
                                carlos: -40,
                                maria: -35,
                                ana: -30
                            },
                            risks: ['Rendimiento extremadamente lento', 'Consumo energ√©tico masivo', 'Tecnolog√≠a inmadura'],
                            benefits: ['Buzzword de moda'],
                            isoCompliance: 'none'
                        },
                        {
                            id: 'serverless_everything',
                            title: 'Arquitectura 100% Serverless',
                            description: 'Funciones lambda para cada operaci√≥n, sin servidores tradicionales',
                            cost: 200000,
                            time: 6,
                            impact: {
                                performance: -15,
                                reliability: -20,
                                carlos: -25,
                                maria: -30
                            },
                            risks: ['Cold starts en emergencias', 'Vendor lock-in extremo', 'Costos impredecibles'],
                            benefits: ['Escalado autom√°tico'],
                            isoCompliance: 'none'
                        }
                    ]
                },
                {
                    id: 'security_framework',
                    title: 'Marco de Seguridad y Privacidad',
                    context: 'Los datos m√©dicos son extremadamente sensibles y est√°n regulados por GDPR y normativas sanitarias. Debes establecer un marco de seguridad robusto seg√∫n ISO 27001.',
                    isoReference: 'ISO 27001:2013 + ISO 13485:2016 - Seguridad de la informaci√≥n para dispositivos m√©dicos.',
                    options: [
                        {
                            id: 'role_based_access',
                            title: 'Control de Acceso Basado en Roles (RBAC)',
                            description: 'Sistema tradicional con permisos por roles m√©dicos espec√≠ficos seg√∫n ISO 27001',
                            cost: 90000,
                            time: 2,
                            impact: {
                                security: 25,
                                usability: -5,
                                carlos: 20,
                                maria: -10
                            },
                            risks: ['Rigidez en emergencias', 'Complejidad de gesti√≥n'],
                            benefits: ['Control granular', 'Auditor√≠a completa'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'context_aware_security',
                            title: 'Seguridad Contextual Adaptativa',
                            description: 'Permisos din√°micos basados en contexto m√©dico, ubicaci√≥n y urgencia',
                            cost: 140000,
                            time: 4,
                            impact: {
                                security: 30,
                                usability: 20,
                                carlos: 25,
                                maria: 20
                            },
                            risks: ['Complejidad t√©cnica alta', 'Falsos positivos/negativos'],
                            benefits: ['Flexibilidad en emergencias', 'Experiencia fluida'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'zero_trust_architecture',
                            title: 'Arquitectura Zero Trust',
                            description: 'Verificaci√≥n continua con cifrado extremo a extremo seg√∫n mejores pr√°cticas ISO 27001',
                            cost: 160000,
                            time: 5,
                            impact: {
                                security: 40,
                                performance: -10,
                                carlos: 30,
                                ana: -20
                            },
                            risks: ['Impacto en rendimiento', 'Costo elevado'],
                            benefits: ['M√°xima seguridad', 'Preparado para amenazas futuras'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'biometric_everything',
                            title: 'Autenticaci√≥n Biom√©trica Total',
                            description: 'ADN, iris, huella, voz y reconocimiento facial para cada acci√≥n',
                            cost: 800000,
                            time: 12,
                            impact: {
                                security: 20,
                                usability: -40,
                                performance: -25,
                                carlos: -50,
                                maria: -60,
                                ana: -30
                            },
                            risks: ['Tiempo excesivo de autenticaci√≥n', 'Fallos en emergencias', 'Costo prohibitivo'],
                            benefits: ['Seguridad te√≥rica m√°xima'],
                            isoCompliance: 'none'
                        },
                        {
                            id: 'public_cloud_only',
                            title: 'Solo Nube P√∫blica Sin Cifrado',
                            description: 'Almacenar todos los datos m√©dicos en nube p√∫blica sin cifrado adicional',
                            cost: 30000,
                            time: 1,
                            impact: {
                                security: -50,
                                privacy: -60,
                                carlos: -40,
                                maria: -70,
                                ana: -20
                            },
                            risks: ['Violaci√≥n masiva de GDPR', 'Datos m√©dicos expuestos', 'Multas millonarias'],
                            benefits: ['Costo inicial bajo'],
                            isoCompliance: 'none'
                        }
                    ]
                },
                {
                    id: 'development_methodology',
                    title: 'Metodolog√≠a de Desarrollo de Software M√©dico',
                    context: 'Para software m√©dico cr√≠tico, debes elegir una metodolog√≠a que balancee agilidad con rigor regulatorio seg√∫n ISO 62304.',
                    isoReference: 'ISO 62304:2006 - Procesos de ciclo de vida del software de dispositivos m√©dicos.',
                    options: [
                        {
                            id: 'regulated_agile',
                            title: 'Agile Regulado ISO 62304',
                            description: 'Metodolog√≠a √°gil adaptada para cumplir con regulaciones m√©dicas y trazabilidad ISO',
                            cost: 120000,
                            time: 3,
                            impact: {
                                flexibility: 25,
                                quality: 30,
                                team_morale: 20,
                                carlos: 30,
                                maria: 15
                            },
                            risks: ['Curva de aprendizaje', 'Documentaci√≥n adicional'],
                            benefits: ['Flexibilidad controlada', 'Compliance ISO 62304'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'waterfall_medical',
                            title: 'Waterfall M√©dico Tradicional',
                            description: 'Metodolog√≠a en cascada tradicional con todas las fases secuenciales seg√∫n V-Model',
                            cost: 100000,
                            time: 6,
                            impact: {
                                predictability: 25,
                                flexibility: -15,
                                quality: 20,
                                ana: 20,
                                carlos: -10
                            },
                            risks: ['Inflexibilidad ante cambios', 'Detecci√≥n tard√≠a de problemas'],
                            benefits: ['Documentaci√≥n completa', 'Proceso probado'],
                            isoCompliance: 'medium'
                        },
                        {
                            id: 'devops_medical',
                            title: 'DevOps M√©dico con CI/CD',
                            description: 'Integraci√≥n y despliegue continuo con validaci√≥n autom√°tica ISO 62304',
                            cost: 150000,
                            time: 4,
                            impact: {
                                speed: 30,
                                quality: 25,
                                efficiency: 20,
                                carlos: 35,
                                maria: 10
                            },
                            risks: ['Complejidad de automatizaci√≥n', 'Cambios culturales necesarios'],
                            benefits: ['Entrega r√°pida', 'Calidad automatizada'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'extreme_programming',
                            title: 'Extreme Programming Sin Documentaci√≥n',
                            description: 'XP puro sin documentaci√≥n formal, solo c√≥digo y tests',
                            cost: 80000,
                            time: 2,
                            impact: {
                                speed: 20,
                                quality: -20,
                                compliance: -40,
                                carlos: -10,
                                maria: -50,
                                ana: -30
                            },
                            risks: ['Sin trazabilidad', 'No auditable', 'Violaci√≥n regulatoria'],
                            benefits: ['Desarrollo muy r√°pido'],
                            isoCompliance: 'none'
                        },
                        {
                            id: 'no_methodology',
                            title: 'Desarrollo Ad-hoc Sin Proceso',
                            description: 'Cada desarrollador trabaja como quiera, sin metodolog√≠a definida',
                            cost: 50000,
                            time: 1,
                            impact: {
                                chaos: 50,
                                quality: -40,
                                predictability: -50,
                                carlos: -60,
                                maria: -70,
                                ana: -40
                            },
                            risks: ['Caos total', 'Calidad impredecible', 'Imposible de auditar'],
                            benefits: ['Libertad creativa'],
                            isoCompliance: 'none'
                        }
                    ]
                }
            ],
            3: [
                {
                    id: 'integration_strategy',
                    title: 'Estrategia de Integraci√≥n con Sistemas Legacy',
                    context: 'El hospital tiene m√∫ltiples sistemas cr√≠ticos funcionando las 24 horas: equipos de laboratorio, sistemas de imagen m√©dica, dispositivos de monitoreo. Debes integrar MedCore sin interrumpir operaciones vitales seg√∫n ISO 14155.',
                    isoReference: 'ISO 14155:2020 - Buenas pr√°cticas cl√≠nicas para la investigaci√≥n de dispositivos m√©dicos en seres humanos.',
                    options: [
                        {
                            id: 'big_bang_migration',
                            title: 'Migraci√≥n Big Bang',
                            description: 'Cambio completo en un fin de semana planificado',
                            cost: 80000,
                            time: 1,
                            impact: {
                                functionality: 25,
                                reliability: -15,
                                maria: -25,
                                carlos: -15,
                                ana: 10
                            },
                            risks: ['Riesgo operacional extremo', 'Sin rollback f√°cil'],
                            benefits: ['Implementaci√≥n r√°pida', 'Menos costos de transici√≥n'],
                            isoCompliance: 'low'
                        },
                        {
                            id: 'gradual_rollout',
                            title: 'Implementaci√≥n Gradual por Departamentos',
                            description: 'Migraci√≥n departamento por departamento durante 6 meses seg√∫n mejores pr√°cticas ISO',
                            cost: 120000,
                            time: 6,
                            impact: {
                                functionality: 20,
                                reliability: 25,
                                maria: 20,
                                carlos: 15,
                                ana: -10
                            },
                            risks: ['Complejidad de datos duplicados', 'Per√≠odo de transici√≥n largo'],
                            benefits: ['Riesgo controlado', 'Aprendizaje iterativo'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'parallel_systems',
                            title: 'Sistemas Paralelos con Sincronizaci√≥n',
                            description: 'Ejecutar ambos sistemas en paralelo con sincronizaci√≥n de datos',
                            cost: 200000,
                            time: 4,
                            impact: {
                                functionality: 15,
                                reliability: 30,
                                security: 10,
                                maria: 25,
                                carlos: 20,
                                ana: -25
                            },
                            risks: ['Alto costo operacional', 'Complejidad de sincronizaci√≥n'],
                            benefits: ['Cero riesgo operacional', 'Rollback inmediato'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'api_gateway_integration',
                            title: 'Integraci√≥n Mediante API Gateway Unificado',
                            description: 'Gateway central que maneja toda la comunicaci√≥n entre sistemas legacy y nuevos seg√∫n ISO 25010',
                            cost: 150000,
                            time: 3,
                            impact: {
                                maintainability: 25,
                                interoperability: 30,
                                security: 20,
                                carlos: 25,
                                maria: 15
                            },
                            risks: ['Punto √∫nico de fallo potencial', 'Latencia adicional'],
                            benefits: ['Integraci√≥n estandarizada', 'Monitoreo centralizado'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'replace_everything_immediately',
                            title: 'Reemplazo Instant√°neo de Todos los Sistemas',
                            description: 'Desconectar todos los sistemas legacy inmediatamente y usar solo MedCore',
                            cost: 50000,
                            time: 0.5,
                            impact: {
                                functionality: -40,
                                reliability: -50,
                                patient_safety: -60,
                                maria: -80,
                                carlos: -70,
                                ana: -50
                            },
                            risks: ['Fallo catastr√≥fico del hospital', 'P√©rdida de datos cr√≠ticos', 'Riesgo de vidas'],
                            benefits: ['Simplicidad extrema'],
                            isoCompliance: 'none'
                        },
                        {
                            id: 'manual_integration_only',
                            title: 'Solo Integraci√≥n Manual Sin Automatizaci√≥n',
                            description: 'Personal introduce manualmente todos los datos entre sistemas',
                            cost: 300000,
                            time: 12,
                            impact: {
                                efficiency: -40,
                                errors: 50,
                                staff_burnout: 60,
                                maria: -50,
                                carlos: -40
                            },
                            risks: ['Errores humanos masivos', 'Burnout del personal', 'Ineficiencia extrema'],
                            benefits: ['No requiere desarrollo t√©cnico'],
                            isoCompliance: 'none'
                        }
                    ]
                },
                {
                    id: 'performance_optimization',
                    title: 'Estrategia de Optimizaci√≥n de Rendimiento',
                    context: 'En situaciones de emergencia, el sistema debe responder en menos de 1 segundo. Durante cirug√≠as cr√≠ticas, cualquier demora puede ser fatal seg√∫n ISO 25010.',
                    isoReference: 'ISO 25010:2011 - Caracter√≠sticas de rendimiento y eficiencia para sistemas cr√≠ticos.',
                    options: [
                        {
                            id: 'database_optimization',
                            title: 'Optimizaci√≥n de Base de Datos Avanzada',
                            description: '√çndices especializados, particionamiento y cache inteligente seg√∫n mejores pr√°cticas',
                            cost: 70000,
                            time: 2,
                            impact: {
                                performance: 30,
                                maintainability: -5,
                                carlos: 20,
                                maria: 15
                            },
                            risks: ['Complejidad de mantenimiento', 'Dependencia de DBA'],
                            benefits: ['Mejora consistente', 'Escalabilidad de datos'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'caching_strategy',
                            title: 'Sistema de Cache Multicapa',
                            description: 'Redis, cache de aplicaci√≥n y CDN para datos cr√≠ticos',
                            cost: 90000,
                            time: 3,
                            impact: {
                                performance: 35,
                                reliability: 10,
                                carlos: 25,
                                maria: 10
                            },
                            risks: ['Inconsistencia de datos', 'Complejidad de invalidaci√≥n'],
                            benefits: ['Respuesta ultra-r√°pida', 'Reducci√≥n de carga DB'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'microservices_scaling',
                            title: 'Auto-escalado de Microservicios',
                            description: 'Escalado autom√°tico basado en demanda en tiempo real',
                            cost: 120000,
                            time: 4,
                            impact: {
                                performance: 40,
                                efficiency: 25,
                                carlos: 30,
                                ana: -15
                            },
                            risks: ['Costos variables impredecibles', 'Complejidad de monitoreo'],
                            benefits: ['Escalabilidad infinita', 'Optimizaci√≥n autom√°tica'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'edge_computing_medical',
                            title: 'Edge Computing en Dispositivos M√©dicos',
                            description: 'Procesamiento local en cada dispositivo para latencia m√≠nima',
                            cost: 200000,
                            time: 6,
                            impact: {
                                performance: 45,
                                reliability: 30,
                                cost_operational: -20,
                                carlos: 35,
                                maria: 25
                            },
                            risks: ['Complejidad de gesti√≥n distribuida', 'Sincronizaci√≥n de datos'],
                            benefits: ['Latencia ultra-baja', 'Funciona sin conectividad'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'quantum_computing_optimization',
                            title: 'Optimizaci√≥n con Computaci√≥n Cu√°ntica',
                            description: 'Usar computadoras cu√°nticas para optimizar todas las consultas de base de datos',
                            cost: 10000000,
                            time: 36,
                            impact: {
                                performance: -10,
                                complexity: 100,
                                practicality: -80,
                                carlos: -60,
                                maria: -70,
                                ana: -50
                            },
                            risks: ['Tecnolog√≠a experimental', 'Costo prohibitivo', 'No aplicable a m√©dico'],
                            benefits: ['Buzzword impresionante'],
                            isoCompliance: 'none'
                        },
                        {
                            id: 'no_optimization_needed',
                            title: 'Sin Optimizaci√≥n - Hardware M√°s Potente',
                            description: 'Solo comprar servidores m√°s caros sin optimizar el c√≥digo',
                            cost: 500000,
                            time: 1,
                            impact: {
                                performance: 10,
                                efficiency: -30,
                                sustainability: -40,
                                carlos: -20,
                                maria: -15,
                                ana: -35
                            },
                            risks: ['Desperdicio de recursos', 'Problemas escalar√°', 'Insostenible'],
                            benefits: ['Soluci√≥n r√°pida aparente'],
                            isoCompliance: 'low'
                        }
                    ]
                },
                {
                    id: 'user_training_approach',
                    title: 'Programa de Capacitaci√≥n del Personal M√©dico',
                    context: 'Tienes que entrenar a 2,500 empleados seg√∫n ISO 13485 competencias. Algunos tienen resistencia al cambio tecnol√≥gico.',
                    isoReference: 'ISO 13485:2016 - Cl√°usula 6.2 Recursos humanos - Competencia, formaci√≥n y toma de conciencia.',
                    options: [
                        {
                            id: 'traditional_classroom',
                            title: 'Capacitaci√≥n Presencial Tradicional',
                            description: 'Cursos presenciales en grupos peque√±os durante horarios no cr√≠ticos',
                            cost: 150000,
                            time: 6,
                            impact: {
                                usability: 25,
                                efficiency: -10,
                                maria: 20,
                                ana: -20
                            },
                            risks: ['Interrumpe operaciones', 'Ritmo lento de adopci√≥n'],
                            benefits: ['Interacci√≥n personal', 'Resoluci√≥n inmediata de dudas'],
                            isoCompliance: 'medium'
                        },
                        {
                            id: 'digital_learning_platform',
                            title: 'Plataforma de Aprendizaje Digital',
                            description: 'M√≥dulos interactivos online con simulaciones del sistema real seg√∫n ISO 25010 usabilidad',
                            cost: 100000,
                            time: 3,
                            impact: {
                                usability: 20,
                                efficiency: 15,
                                carlos: 25,
                                maria: 10,
                                ana: 15
                            },
                            risks: ['Menor retenci√≥n', 'Brecha digital generacional'],
                            benefits: ['Flexibilidad horaria', 'Escalable a toda la organizaci√≥n'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'peer_champion_network',
                            title: 'Red de Champions por Departamento',
                            description: 'Entrenar super-usuarios que ense√±en a sus colegas en contexto real',
                            cost: 80000,
                            time: 4,
                            impact: {
                                usability: 30,
                                efficiency: 20,
                                maria: 30,
                                carlos: 15,
                                ana: 10
                            },
                            risks: ['Calidad inconsistente', 'Dependencia de individuos clave'],
                            benefits: ['Adopci√≥n org√°nica', 'Conocimiento contextualizado'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'vr_training_immersive',
                            title: 'Capacitaci√≥n Inmersiva con Realidad Virtual',
                            description: 'Entornos VR que simulan perfectamente el hospital y sistemas reales',
                            cost: 300000,
                            time: 8,
                            impact: {
                                engagement: 40,
                                retention: 35,
                                usability: 25,
                                carlos: 30,
                                maria: 20
                            },
                            risks: ['Costo muy elevado', 'Motion sickness', 'Curva tecnol√≥gica'],
                            benefits: ['Experiencia inmersiva', 'Entrenamiento sin riesgo'],
                            isoCompliance: 'medium'
                        },
                        {
                            id: 'no_training_intuitive',
                            title: 'Sin Capacitaci√≥n - Sistema Auto-explicativo',
                            description: 'El sistema es tan intuitivo que no necesita capacitaci√≥n formal',
                            cost: 0,
                            time: 0,
                            impact: {
                                usability: -50,
                                errors: 80,
                                compliance: -70,
                                maria: -70,
                                carlos: -60,
                                ana: -40
                            },
                            risks: ['Uso incorrecto masivo', 'Errores m√©dicos', 'No compliance'],
                            benefits: ['Ahorro aparente'],
                            isoCompliance: 'none'
                        },
                        {
                            id: 'external_consultants_only',
                            title: 'Solo Consultores Externos Sin Contexto',
                            description: 'Contratar consultores externos que no conocen el hospital para toda la capacitaci√≥n',
                            cost: 400000,
                            time: 12,
                            impact: {
                                relevance: -40,
                                adoption: -30,
                                maria: -40,
                                carlos: -20
                            },
                            risks: ['Falta de contexto m√©dico', 'Capacitaci√≥n gen√©rica', 'Baja adopci√≥n'],
                            benefits: ['Expertise externo'],
                            isoCompliance: 'low'
                        }
                    ]
                },
                {
                    id: 'quality_assurance_final',
                    title: 'Estrategia Final de Aseguramiento de Calidad',
                    context: 'Antes del lanzamiento, debes implementar el sistema final de QA que garantice que ning√∫n error llegue a producci√≥n seg√∫n ISO 62304.',
                    isoReference: 'ISO 62304:2006 - Proceso de software de dispositivos m√©dicos - Actividades de verificaci√≥n y validaci√≥n.',
                    options: [
                        {
                            id: 'comprehensive_testing_iso',
                            title: 'Testing Comprehensivo ISO 62304',
                            description: 'Suite completa de tests unitarios, integraci√≥n, sistema y aceptaci√≥n seg√∫n est√°ndar',
                            cost: 200000,
                            time: 4,
                            impact: {
                                quality: 40,
                                reliability: 35,
                                compliance: 40,
                                carlos: 30,
                                maria: 25
                            },
                            risks: ['Tiempo extenso', 'Costo elevado'],
                            benefits: ['M√°xima calidad', 'Cumplimiento total ISO'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'risk_based_testing_advanced',
                            title: 'Testing Basado en Riesgos M√©dicos',
                            description: 'Enfoque en escenarios cr√≠ticos donde fallos pueden afectar vidas humanas',
                            cost: 150000,
                            time: 3,
                            impact: {
                                safety: 45,
                                efficiency: 20,
                                maria: 35,
                                carlos: 25
                            },
                            risks: ['√Åreas no cr√≠ticas menos probadas'],
                            benefits: ['Foco en seguridad de pacientes', 'Optimizaci√≥n de recursos'],
                            isoCompliance: 'high'
                        },
                        {
                            id: 'automated_testing_ai',
                            title: 'Testing Automatizado con IA',
                            description: 'IA que genera y ejecuta tests autom√°ticamente basados en uso real',
                            cost: 250000,
                            time: 5,
                            impact: {
                                coverage: 50,
                                innovation: 30,
                                carlos: 40,
                                ana: 20
                            },
                            risks: ['Dependencia de IA', 'Tests pueden ser irrelevantes'],
                            benefits: ['Cobertura amplia', 'Detecci√≥n de casos edge'],
                            isoCompliance: 'medium'
                        },
                        {
                            id: 'crowdsourced_testing',
                            title: 'Testing Crowdsourced P√∫blico',
                            description: 'Permitir que cualquier persona en internet pruebe el sistema m√©dico',
                            cost: 20000,
                            time: 1,
                            impact: {
                                security: -80,
                                privacy: -90,
                                compliance: -100,
                                maria: -100,
                                carlos: -80
                            },
                            risks: ['Exposici√≥n de datos m√©dicos', 'Violaci√≥n masiva GDPR', 'Acceso no autorizado'],
                            benefits: ['Costo bajo', 'Muchos testers'],
                            isoCompliance: 'none'
                        },
                        {
                            id: 'minimal_testing_speed',
                            title: 'Testing M√≠nimo por Velocidad',
                            description: 'Solo probar funcionalidades b√°sicas para lanzar r√°pido',
                            cost: 30000,
                            time: 0.5,
                            impact: {
                                speed: 20,
                                quality: -60,
                                safety: -70,
                                maria: -80,
                                carlos: -50
                            },
                            risks: ['Errores cr√≠ticos no detectados', 'Fallas en producci√≥n', 'Riesgo de vidas'],
                            benefits: ['Lanzamiento r√°pido'],
                            isoCompliance: 'none'
                        }
                    ]
                },
                {
                    id: 'user_training_approach',
                    title: 'Programa de Capacitaci√≥n del Personal M√©dico',
                    context: 'Tienes que entrenar a 2,500 empleados en el nuevo sistema, desde cirujanos hasta personal administrativo. Algunos tienen resistencia al cambio tecnol√≥gico. El entrenamiento debe ser efectivo pero no puede interrumpir la atenci√≥n al paciente.',
                    isoReference: 'ISO 13485:2016 - Cl√°usula 6.2 Recursos humanos',
                    options: [
                        {
                            id: 'traditional_classroom',
                            title: 'Capacitaci√≥n Presencial Tradicional',
                            description: 'Cursos presenciales en grupos peque√±os durante horarios no cr√≠ticos',
                            cost: 150000,
                            time: 6,
                            impact: {
                                usability: 25,
                                efficiency: -10,
                                maria: 20,
                                ana: -20
                            },
                            risks: ['Interrumpe operaciones', 'Ritmo lento de adopci√≥n'],
                            benefits: ['Interacci√≥n personal', 'Resoluci√≥n inmediata de dudas']
                        },
                        {
                            id: 'digital_learning_platform',
                            title: 'Plataforma de Aprendizaje Digital',
                            description: 'M√≥dulos interactivos online con simulaciones del sistema real',
                            cost: 100000,
                            time: 3,
                            impact: {
                                usability: 20,
                                efficiency: 15,
                                carlos: 25,
                                maria: 10,
                                ana: 15
                            },
                            risks: ['Menor retenci√≥n', 'Brecha digital generacional'],
                            benefits: ['Flexibilidad horaria', 'Escalable a toda la organizaci√≥n']
                        },
                        {
                            id: 'peer_champion_network',
                            title: 'Red de Champions por Departamento',
                            description: 'Entrenar super-usuarios que ense√±en a sus colegas en contexto real',
                            cost: 80000,
                            time: 4,
                            impact: {
                                usability: 30,
                                efficiency: 20,
                                maria: 30,
                                carlos: 15,
                                ana: 10
                            },
                            risks: ['Calidad inconsistente', 'Dependencia de individuos clave'],
                            benefits: ['Adopci√≥n org√°nica', 'Conocimiento contextualizado'],
                            isoCompliance: 'high'
                        }
                    ]
                }
            ],
            4: [
                {
                    id: 'deployment_strategy',
                    title: 'Estrategia de Despliegue Final',
                    context: 'Es el momento cr√≠tico. Despu√©s de 15 meses de desarrollo, debes desplegar el sistema completo. Un error aqu√≠ podr√≠a comprometer vidas y la reputaci√≥n del hospital. Debes equilibrar velocidad, seguridad y continuidad operacional.',
                    isoReference: 'ISO 62304:2006 - Software de dispositivos m√©dicos',
                    options: [
                        {
                            id: 'blue_green_deployment',
                            title: 'Despliegue Blue-Green',
                            description: 'Dos entornos id√©nticos, cambio instant√°neo con rollback completo',
                            cost: 100000,
                            time: 2,
                            impact: {
                                reliability: 30,
                                efficiency: 15,
                                carlos: 25,
                                maria: 20
                            },
                            risks: ['Doble infraestructura costosa', 'Sincronizaci√≥n de datos compleja'],
                            benefits: ['Rollback instant√°neo', 'Cero downtime']
                        },
                        {
                            id: 'canary_release',
                            title: 'Lanzamiento Canario',
                            description: 'Despliegue gradual comenzando con departamentos no cr√≠ticos',
                            cost: 60000,
                            time: 4,
                            impact: {
                                reliability: 25,
                                functionality: 10,
                                maria: 25,
                                ana: 15
                            },
                            risks: ['Detecci√≥n tard√≠a de problemas cr√≠ticos', 'Experiencia inconsistente'],
                            benefits: ['Validaci√≥n real progresiva', 'Riesgo distribuido']
                        },
                        {
                            id: 'feature_toggles',
                            title: 'Activaci√≥n por Caracter√≠sticas',
                            description: 'Despliegue completo pero con funcionalidades activables en tiempo real',
                            cost: 80000,
                            time: 3,
                            impact: {
                                reliability: 20,
                                maintainability: 25,
                                carlos: 30,
                                maria: 15
                            },
                            risks: ['Complejidad de configuraci√≥n', 'Posibles estados inconsistentes'],
                            benefits: ['Control granular', 'Activaci√≥n/desactivaci√≥n inmediata']
                        }
                    ]
                },
                {
                    id: 'monitoring_alerting',
                    title: 'Sistema de Monitoreo y Alertas',
                    context: 'Una vez en producci√≥n, necesitas detectar problemas antes de que afecten a los pacientes. El sistema debe monitorear desde el rendimiento t√©cnico hasta indicadores cl√≠nicos de calidad de atenci√≥n.',
                    isoReference: 'ISO 25010:2011 - Calidad del software',
                    options: [
                        {
                            id: 'basic_infrastructure_monitoring',
                            title: 'Monitoreo B√°sico de Infraestructura',
                            description: 'CPU, memoria, disco y disponibilidad de servicios b√°sicos',
                            cost: 40000,
                            time: 1,
                            impact: {
                                reliability: 15,
                                efficiency: 10,
                                carlos: 15,
                                ana: 10
                            },
                            risks: ['Detecci√≥n tard√≠a de problemas', 'Sin contexto de negocio'],
                            benefits: ['Implementaci√≥n r√°pida', 'Costo bajo']
                        },
                        {
                            id: 'application_performance_monitoring',
                            title: 'Monitoreo de Rendimiento de Aplicaci√≥n (APM)',
                            description: 'Trazabilidad de transacciones, an√°lisis de cuellos de botella y errores',
                            cost: 80000,
                            time: 2,
                            impact: {
                                reliability: 25,
                                performance: 20,
                                carlos: 25,
                                maria: 10
                            },
                            risks: ['Overhead de rendimiento', 'Complejidad de configuraci√≥n'],
                            benefits: ['Diagn√≥stico preciso', 'Optimizaci√≥n proactiva']
                        },
                        {
                            id: 'business_intelligence_monitoring',
                            title: 'Monitoreo de Inteligencia de Negocio M√©dico',
                            description: 'KPIs cl√≠nicos, m√©tricas de calidad de atenci√≥n y an√°lisis predictivo',
                            cost: 150000,
                            time: 4,
                            impact: {
                                reliability: 20,
                                functionality: 30,
                                efficiency: 25,
                                maria: 30,
                                carlos: 20,
                                ana: 15
                            },
                            risks: ['Complejidad anal√≠tica alta', 'Requiere expertise m√©dico'],
                            benefits: ['Valor cl√≠nico directo', 'Mejora continua basada en datos']
                        }
                    ]
                },
                {
                    id: 'success_metrics',
                    title: 'Definici√≥n de M√©tricas de √âxito Post-Implementaci√≥n',
                    context: 'El proyecto est√° t√©cnicamente completo, pero ¬øc√≥mo medir√°s si realmente ha sido exitoso? Debes establecer KPIs que demuestren el valor real del sistema para el hospital y los pacientes.',
                    isoReference: 'ISO 25010:2011 - M√©tricas de calidad del software',
                    options: [
                        {
                            id: 'technical_metrics_focus',
                            title: 'Enfoque en M√©tricas T√©cnicas',
                            description: 'Uptime, tiempo de respuesta, throughput y errores del sistema',
                            cost: 20000,
                            time: 1,
                            impact: {
                                reliability: 15,
                                carlos: 20,
                                ana: 15
                            },
                            risks: ['No mide valor de negocio', 'Desconexi√≥n con usuarios finales'],
                            benefits: ['Medici√≥n objetiva', 'F√°cil de automatizar']
                        },
                        {
                            id: 'user_experience_metrics',
                            title: 'M√©tricas de Experiencia de Usuario',
                            description: 'Satisfacci√≥n del personal, tiempo de tareas y curva de adopci√≥n',
                            cost: 50000,
                            time: 2,
                            impact: {
                                usability: 25,
                                efficiency: 15,
                                maria: 25,
                                ana: 10
                            },
                            risks: ['Subjetividad en mediciones', 'Influencias externas'],
                            benefits: ['Enfoque en valor real', 'Mejora continua centrada en usuarios']
                        },
                        {
                            id: 'patient_outcome_metrics',
                            title: 'M√©tricas de Resultados Cl√≠nicos',
                            description: 'Tiempo de atenci√≥n, errores m√©dicos evitados, satisfacci√≥n del paciente',
                            cost: 100000,
                            time: 6,
                            impact: {
                                functionality: 30,
                                efficiency: 25,
                                maria: 35,
                                carlos: 15,
                                ana: 20
                            },
                            risks: ['M√∫ltiples variables influyentes', 'Largo tiempo de medici√≥n'],
                            benefits: ['ROI demostrable', 'Impacto directo en salud']
                        }
                    ]
                }
            ]
        };

        // Funci√≥n para cargar contenido de fase
        function loadPhaseContent() {
            const mainContent = document.getElementById('main-content');
            
            switch(gameState.currentPhase) {
                case 1:
                    mainContent.innerHTML = `
                        <div class="phase-container">
                            <div class="phase-header">
                                <h1>üîç Fase 1: An√°lisis y Definici√≥n de Requisitos</h1>
                                <p class="phase-description">
                                    Define los requisitos que determinar√°n el √©xito del proyecto MedCore. 
                                    Tu selecci√≥n impactar√° directamente en la funcionalidad, costos y satisfacci√≥n de stakeholders.
                                </p>
                            </div>

                            <div class="challenge-section">
                                <div class="challenge-header">
                                    <h2>üéØ Desaf√≠o Principal</h2>
                                    <div class="difficulty-indicator">
                                        <span class="difficulty-level">Dificultad: Alta</span>
                                        <span class="time-pressure">‚è∞ Presi√≥n de Tiempo</span>
                                    </div>
                                </div>
                                
                                <div class="challenge-content">
                                    <p>El hospital opera 24/7 con procesos cr√≠ticos para la vida. Debes:</p>
                                    <ul class="challenge-list">
                                        <li>Seleccionar requisitos estrat√©gicos del cat√°logo</li>
                                        <li>Equilibrar necesidades conflictivas de stakeholders</li>
                                        <li>Aplicar est√°ndares ISO 29148 e ISO 25010</li>
                                        <li>Mantener el proyecto dentro del presupuesto</li>
                                    </ul>
                                </div>
                                
                                <div class="challenge-actions">
                                    <button class="action-btn primary large" onclick="openRequirementsModal()">
                                        üìã Definir Requisitos del Sistema
                                    </button>
                                    <button class="action-btn secondary" onclick="openDecisionModal('requirements_methodology')">
                                        ü§î Decidir Metodolog√≠a de Requisitos
                                    </button>
                                    <button class="action-btn secondary" onclick="openDecisionModal('quality_approach')">
                                        üõ°Ô∏è Estrategia de Calidad
                                    </button>
                                    <button class="action-btn info" onclick="advanceToPhase2()">
                                        ‚û°Ô∏è Avanzar a Fase 2
                                    </button>
                                </div>
                            </div>

                            <div class="phase-guidance">
                                <h3>üí° Orientaci√≥n T√©cnica</h3>
                                <div class="guidance-cards">
                                    <div class="guidance-card">
                                        <h4>üìö ISO 29148</h4>
                                        <p>Los requisitos deben ser verificables, no ambiguos y trazables a necesidades del negocio.</p>
                                    </div>
                                    <div class="guidance-card">
                                        <h4>‚ö° ISO 25010</h4>
                                        <p>Considera las 8 caracter√≠sticas de calidad: funcionalidad, rendimiento, compatibilidad, usabilidad, fiabilidad, seguridad, mantenibilidad y portabilidad.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 2:
                    mainContent.innerHTML = `
                        <div class="phase-container">
                            <div class="phase-header">
                                <h1>üèóÔ∏è Fase 2: Dise√±o y Arquitectura del Sistema</h1>
                                <p class="phase-description">
                                    Con los requisitos definidos, ahora debes dise√±ar la arquitectura t√©cnica que soportar√° el sistema MedCore durante los pr√≥ximos 10+ a√±os. Estas decisiones son irreversibles y cr√≠ticas.
                                </p>
                            </div>

                            <div class="challenge-section">
                                <div class="challenge-header">
                                    <h2>üéØ Decisiones Arquitecturales Cr√≠ticas</h2>
                                    <div class="difficulty-indicator">
                                        <span class="difficulty-level">Dificultad: Extrema</span>
                                        <span class="time-pressure">‚ö° Impacto a Largo Plazo</span>
                                    </div>
                                </div>
                                
                                <div class="challenge-content">
                                    <p>Las decisiones arquitecturales determinar√°n el √©xito a largo plazo:</p>
                                    <ul class="challenge-list">
                                        <li>Elegir patr√≥n arquitectural fundamental del sistema</li>
                                        <li>Definir marco de seguridad para datos m√©dicos cr√≠ticos</li>
                                        <li>Aplicar est√°ndares ISO 12207 e ISO 27001</li>
                                        <li>Balancear escalabilidad vs complejidad operacional</li>
                                    </ul>
                                </div>
                                
                                <div class="challenge-actions">
                                    <button class="action-btn primary large" onclick="openDecisionModal('architecture_pattern')">
                                        üèõÔ∏è Definir Arquitectura del Sistema
                                    </button>
                                    <button class="action-btn primary" onclick="openDecisionModal('security_framework')">
                                        üîê Marco de Seguridad y Privacidad
                                    </button>
                                    <button class="action-btn secondary" onclick="showArchitectureAnalysis()">
                                        üìä An√°lisis de Arquitectura
                                    </button>
                                    <button class="action-btn info" onclick="advanceToPhase3()">
                                        ‚û°Ô∏è Avanzar a Fase 3
                                    </button>
                                </div>
                            </div>

                            <div class="phase-guidance">
                                <h3>üí° Orientaci√≥n T√©cnica - Fase 2</h3>
                                <div class="guidance-cards">
                                    <div class="guidance-card">
                                        <h4>üèóÔ∏è ISO 12207</h4>
                                        <p>Define procesos para el dise√±o arquitectural, considerando interfaces, datos y comportamiento del sistema.</p>
                                    </div>
                                    <div class="guidance-card">
                                        <h4>üîí ISO 27001</h4>
                                        <p>Gesti√≥n de seguridad de la informaci√≥n, cr√≠tico para datos m√©dicos sensibles.</p>
                                    </div>
                                    <div class="guidance-card">
                                        <h4>‚öñÔ∏è Consideraciones Cr√≠ticas</h4>
                                        <p>Balancear rendimiento, escalabilidad, mantenibilidad y costos operacionales.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 3:
                    mainContent.innerHTML = `
                        <div class="phase-container">
                            <div class="phase-header">
                                <h1>‚öôÔ∏è Fase 3: Desarrollo e Implementaci√≥n</h1>
                                <p class="phase-description">
                                    La fase m√°s cr√≠tica y peligrosa. Debes implementar el sistema sin interrumpir las operaciones vitales del hospital, optimizar el rendimiento para situaciones de emergencia y preparar al personal m√©dico.
                                </p>
                            </div>

                            <div class="challenge-section">
                                <div class="challenge-header">
                                    <h2>üéØ Implementaci√≥n en Entorno Cr√≠tico</h2>
                                    <div class="difficulty-indicator">
                                        <span class="difficulty-level">Dificultad: Cr√≠tica</span>
                                        <span class="time-pressure">üö® Riesgo Operacional</span>
                                    </div>
                                </div>
                                
                                <div class="challenge-content">
                                    <p>Implementar en un hospital en funcionamiento requiere:</p>
                                    <ul class="challenge-list">
                                        <li>Integraci√≥n con sistemas legacy sin interrupciones</li>
                                        <li>Optimizaci√≥n de rendimiento para emergencias m√©dicas</li>
                                        <li>Capacitaci√≥n de 2,500 empleados sin afectar la atenci√≥n</li>
                                        <li>Aplicar ISO 25010 para calidad en producci√≥n</li>
                                    </ul>
                                </div>
                                
                                <div class="challenge-actions">
                                    <button class="action-btn primary large" onclick="openDecisionModal('integration_strategy')">
                                        üîó Estrategia de Integraci√≥n
                                    </button>
                                    <button class="action-btn primary" onclick="openDecisionModal('performance_optimization')">
                                        ‚ö° Optimizaci√≥n de Rendimiento
                                    </button>
                                    <button class="action-btn primary" onclick="openDecisionModal('user_training_approach')">
                                        üë• Programa de Capacitaci√≥n
                                    </button>
                                    <button class="action-btn secondary" onclick="showImplementationRisks()">
                                        ‚ö†Ô∏è An√°lisis de Riesgos
                                    </button>
                                    <button class="action-btn info" onclick="advanceToPhase4()">
                                        ‚û°Ô∏è Avanzar a Fase Final
                                    </button>
                                </div>
                            </div>

                            <div class="phase-guidance">
                                <h3>üí° Orientaci√≥n T√©cnica - Fase 3</h3>
                                <div class="guidance-cards">
                                    <div class="guidance-card">
                                        <h4>üîÑ ISO 25010</h4>
                                        <p>Asegurar caracter√≠sticas de calidad en producci√≥n: rendimiento, fiabilidad y seguridad.</p>
                                    </div>
                                    <div class="guidance-card">
                                        <h4>üè• Consideraciones M√©dicas</h4>
                                        <p>En emergencias, 1 segundo de demora puede ser cr√≠tico. El sistema debe ser m√°s r√°pido que los procesos actuales.</p>
                                    </div>
                                    <div class="guidance-card">
                                        <h4>üë®‚Äç‚öïÔ∏è Factor Humano</h4>
                                        <p>El personal m√©dico tiene resistencia al cambio. La capacitaci√≥n debe ser pr√°ctica y contextual.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 4:
                    mainContent.innerHTML = `
                        <div class="phase-container">
                            <div class="phase-header">
                                <h1>üöÄ Fase 4: Despliegue y Go-Live</h1>
                                <p class="phase-description">
                                    El momento de la verdad. Despu√©s de 18 meses de trabajo, debes poner en producci√≥n el sistema MedCore. Un error aqu√≠ compromete vidas humanas, la operaci√≥n del hospital y tu carrera profesional.
                                </p>
                            </div>

                            <div class="challenge-section">
                                <div class="challenge-header">
                                    <h2>üéØ Lanzamiento en Producci√≥n</h2>
                                    <div class="difficulty-indicator">
                                        <span class="difficulty-level">Dificultad: EXTREMA</span>
                                        <span class="time-pressure">üíÄ Riesgo de Vidas</span>
                                    </div>
                                </div>
                                
                                <div class="challenge-content">
                                    <p><strong>ATENCI√ìN:</strong> Este es el momento m√°s cr√≠tico del proyecto:</p>
                                    <ul class="challenge-list">
                                        <li>Estrategia de despliegue con cero tolerancia a errores</li>
                                        <li>Monitoreo 24/7 para detectar problemas antes que afecten pacientes</li>
                                        <li>M√©tricas de √©xito que demuestren valor real al hospital</li>
                                        <li>Plan de contingencia para rollback en situaciones cr√≠ticas</li>
                                    </ul>
                                    
                                    <div class="critical-warning">
                                        <strong>‚ö†Ô∏è ADVERTENCIA CR√çTICA:</strong> En las siguientes 72 horas se determinar√° si el proyecto de 18 meses y ‚Ç¨2.5M es un √©xito o un desastre que podr√≠a costar vidas.
                                    </div>
                                </div>
                                
                                <div class="challenge-actions">
                                    <button class="action-btn primary large critical" onclick="openDecisionModal('deployment_strategy')">
                                        üöÄ EJECUTAR DESPLIEGUE
                                    </button>
                                    <button class="action-btn primary" onclick="openDecisionModal('monitoring_alerting')">
                                        üìä Sistema de Monitoreo
                                    </button>
                                    <button class="action-btn primary" onclick="openDecisionModal('success_metrics')">
                                        üìà M√©tricas de √âxito
                                    </button>
                                    <button class="action-btn secondary" onclick="showFinalRiskAssessment()">
                                        üîç Evaluaci√≥n Final de Riesgos
                                    </button>
                                    <button class="action-btn success large" onclick="completeProject()">
                                        üèÜ COMPLETAR PROYECTO
                                    </button>
                                </div>
                            </div>

                            <div class="phase-guidance">
                                <h3>üí° Orientaci√≥n Cr√≠tica - Fase Final</h3>
                                <div class="guidance-cards">
                                    <div class="guidance-card critical">
                                        <h4>üéØ Objetivos Cr√≠ticos</h4>
                                        <p>Cero downtime, cero p√©rdida de datos, cero errores que afecten la atenci√≥n al paciente.</p>
                                    </div>
                                    <div class="guidance-card critical">
                                        <h4>üìä KPIs de Supervivencia</h4>
                                        <p>Tiempo de respuesta < 1 seg, disponibilidad > 99.9%, satisfacci√≥n del personal > 80%.</p>
                                    </div>
                                    <div class="guidance-card critical">
                                        <h4>üö® Plan de Contingencia</h4>
                                        <p>Rollback completo en < 15 minutos si se detecta cualquier impacto en la atenci√≥n al paciente.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                    
                default:
                    showProjectCompleted();
                    break;
            }
            
            updateDashboard();
        }

        // Funci√≥n para abrir modal de requisitos
        function openRequirementsModal() {
            document.getElementById('requirements-modal').style.display = 'flex';
            switchCategory('functional');
            updateRequirementsList();
        }

        function closeRequirementsModal() {
            document.getElementById('requirements-modal').style.display = 'none';
        }

        function switchCategory(category) {
            // Actualizar tabs
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-category="${category}"]`).classList.add('active');
            
            // Cargar requisitos de la categor√≠a
            const requirementsList = document.getElementById('requirements-list');
            const requirements = requirementsCatalog[category];
            
            requirementsList.innerHTML = requirements.map(req => `
                <div class="requirement-item ${gameState.selectedRequirements.includes(req.id) ? 'selected' : ''} ${req.isDistractor ? 'distractor' : ''}" 
                     data-requirement-id="${req.id}" onclick="toggleRequirement('${req.id}')">
                    <div class="requirement-header">
                        <div class="requirement-title">
                            <input type="checkbox" ${gameState.selectedRequirements.includes(req.id) ? 'checked' : ''} 
                                   onchange="toggleRequirement('${req.id}')">
                            <h4>${req.title}</h4>
                            ${req.isDistractor ? '<span class="distractor-warning" title="‚ö†Ô∏è Opci√≥n problem√°tica">‚ö†Ô∏è</span>' : ''}
                            <button class="help-btn small" onclick="showRequirementHelp('${req.id}')" title="Ayuda ISO para este requisito">?</button>
                        </div>
                        <div class="requirement-cost">‚Ç¨${req.cost.toLocaleString()}</div>
                    </div>
                    
                    <p class="requirement-description">${req.description}</p>
                    
                    <div class="requirement-details">
                        <div class="complexity-indicator">
                            <span class="complexity-label">Complejidad:</span>
                            <span class="complexity-value ${req.complexity}">${req.complexity.toUpperCase()}</span>
                        </div>
                        <div class="iso-standard-detailed">
                            <strong>üìã ${req.iso_standard}</strong>
                            <p class="iso-benefit">${req.iso_benefit}</p>
                        </div>
                    </div>
                    
                    <div class="requirement-impact">
                        <strong>Impacto esperado:</strong>
                        ${Object.entries(req.impact).map(([metric, value]) => {
                            const isNegative = value < 0;
                            return `<span class="impact-item ${isNegative ? 'negative' : 'positive'}">${metric}: ${isNegative ? '' : '+'}${value}</span>`;
                        }).join('')}
                    </div>
                    
                    ${req.isDistractor ? `
                        <div class="distractor-explanation">
                            <strong>‚ö†Ô∏è Advertencia:</strong> ${req.distractorReason}
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function toggleRequirement(requirementId) {
            const maxSelections = 8;
            const currentSelections = gameState.selectedRequirements.length;
            
            if (gameState.selectedRequirements.includes(requirementId)) {
                // Deseleccionar
                gameState.selectedRequirements = gameState.selectedRequirements.filter(id => id !== requirementId);
            } else {
                // Seleccionar si no se ha alcanzado el l√≠mite
                if (currentSelections < maxSelections) {
                    gameState.selectedRequirements.push(requirementId);
                } else {
                    showFeedbackModal('L√≠mite Alcanzado', 'Has alcanzado el l√≠mite de 8 requisitos. Deselecciona otros antes de a√±adir nuevos.', 'warning');
                    return;
                }
            }
            
            updateRequirementsList();
            updateRequirementsCounter();
            calculateBudgetImpact();
        }

        function updateRequirementsList() {
            const items = document.querySelectorAll('.requirement-item');
            items.forEach(item => {
                const reqId = item.dataset.requirementId;
                const checkbox = item.querySelector('input[type="checkbox"]');
                
                if (gameState.selectedRequirements.includes(reqId)) {
                    item.classList.add('selected');
                    checkbox.checked = true;
                } else {
                    item.classList.remove('selected');
                    checkbox.checked = false;
                }
            });
        }

        function updateRequirementsCounter() {
            document.getElementById('selected-count').textContent = gameState.selectedRequirements.length;
            
            const confirmBtn = document.getElementById('confirm-requirements');
            if (gameState.selectedRequirements.length >= 5) {
                confirmBtn.disabled = false;
            } else {
                confirmBtn.disabled = true;
            }
        }

        function calculateBudgetImpact() {
            let totalCost = 0;
            
            gameState.selectedRequirements.forEach(reqId => {
                Object.values(requirementsCatalog).flat().forEach(req => {
                    if (req.id === reqId) {
                        totalCost += req.cost;
                    }
                });
            });
            
            document.getElementById('budget-impact').textContent = `‚Ç¨${totalCost.toLocaleString()}`;
            
            // Validar presupuesto
            if (totalCost > gameState.budget * 0.6) { // M√°ximo 60% del presupuesto en requisitos
                document.getElementById('budget-impact').style.color = 'red';
            } else {
                document.getElementById('budget-impact').style.color = 'green';
            }
        }

        function confirmRequirements() {
            if (gameState.selectedRequirements.length < 5) {
                showFeedbackModal('Selecci√≥n Insuficiente', 'Debes seleccionar al menos 5 requisitos para un sistema viable.', 'warning');
                return;
            }
            
            // Aplicar impactos de los requisitos seleccionados
            let totalCost = 0;
            let impacts = {};
            
            gameState.selectedRequirements.forEach(reqId => {
                Object.values(requirementsCatalog).flat().forEach(req => {
                    if (req.id === reqId) {
                        totalCost += req.cost;
                        Object.entries(req.impact).forEach(([metric, value]) => {
                            if (!impacts[metric]) impacts[metric] = 0;
                            impacts[metric] += value;
                        });
                    }
                });
            });
            
            // Actualizar estado del juego
            gameState.budget -= totalCost;
            Object.entries(impacts).forEach(([metric, value]) => {
                if (gameState.metrics[metric]) {
                    gameState.metrics[metric] = Math.min(100, gameState.metrics[metric] + value);
                }
            });
            
            closeRequirementsModal();
            
            // Mostrar feedback educativo
            showFeedbackModal(
                'Requisitos Definidos Exitosamente',
                `Has seleccionado ${gameState.selectedRequirements.length} requisitos estrat√©gicos. 
                Esta selecci√≥n impact√≥ el presupuesto en ‚Ç¨${totalCost.toLocaleString()} y mejor√≥ 
                m√∫ltiples m√©tricas de calidad del sistema.`,
                'success',
                {
                    'ISO 29148': 'Requisitos definidos con criterios verificables y trazabilidad completa.',
                    'ISO 25010': 'Se consideraron las caracter√≠sticas de calidad en la selecci√≥n.'
                }
            );
            
            addNotification(`Requisitos definidos: ${gameState.selectedRequirements.length} elementos seleccionados`, 'success');
            updateDashboard();
        }

        // Funci√≥n para abrir modal de decisiones
        function openDecisionModal(decisionId) {
            const decision = phaseDecisions[gameState.currentPhase].find(d => d.id === decisionId);
            if (!decision) return;
            
            gameState.currentDecision = decision;
            
            document.getElementById('decision-title').textContent = decision.title;
            document.getElementById('decision-context').innerHTML = `
                <div class="context-description">
                    <p>${decision.context}</p>
                </div>
            `;
            
            const optionsHtml = decision.options.map((option, index) => `
                <div class="decision-option" data-option-id="${option.id}" onclick="selectDecisionOption('${option.id}')">
                    <div class="option-header">
                        <input type="radio" name="decision-option" value="${option.id}">
                        <h4>${option.title}</h4>
                    </div>
                    
                    <p class="option-description">${option.description}</p>
                    
                    <div class="option-details">
                        <div class="option-costs">
                            <span class="cost-item">üí∞ ‚Ç¨${option.cost.toLocaleString()}</span>
                            <span class="cost-item">‚è±Ô∏è ${option.time} meses</span>
                        </div>
                        
                        <div class="option-risks">
                            <strong>Riesgos:</strong> ${option.risks.join(', ')}
                        </div>
                        
                        <div class="option-benefits">
                            <strong>Beneficios:</strong> ${option.benefits.join(', ')}
                        </div>
                    </div>
                </div>
            `).join('');
            
            document.getElementById('decision-options').innerHTML = optionsHtml;
            document.getElementById('decision-modal').style.display = 'flex';
        }

        function selectDecisionOption(optionId) {
            // Limpiar selecciones previas
            document.querySelectorAll('.decision-option').forEach(opt => opt.classList.remove('selected'));
            document.querySelectorAll('input[name="decision-option"]').forEach(radio => radio.checked = false);
            
            // Seleccionar nueva opci√≥n
            const selectedOption = document.querySelector(`[data-option-id="${optionId}"]`);
            selectedOption.classList.add('selected');
            selectedOption.querySelector('input[type="radio"]').checked = true;
            
            gameState.currentSelectedOption = optionId;
            
            // Mostrar preview del impacto
            const decision = gameState.currentDecision;
            const option = decision.options.find(opt => opt.id === optionId);
            
            document.getElementById('impact-preview').innerHTML = `
                <div class="impact-summary">
                    <h5>Cambios Esperados:</h5>
                    ${Object.entries(option.impact).map(([key, value]) => {
                        if (typeof value === 'number') {
                            const isPositive = value > 0;
                            return `<div class="impact-item ${isPositive ? 'positive' : 'negative'}">
                                ${key}: ${isPositive ? '+' : ''}${value}
                            </div>`;
                        }
                        return '';
                    }).join('')}
                    
                    <div class="cost-impact">
                        <strong>Costo:</strong> ‚Ç¨${option.cost.toLocaleString()}
                    </div>
                </div>
            `;
            
            document.getElementById('confirm-decision').disabled = false;
        }

        function executeDecision() {
            if (!gameState.currentSelectedOption) return;
            
            const decision = gameState.currentDecision;
            const selectedOption = decision.options.find(opt => opt.id === gameState.currentSelectedOption);
            
            // Aplicar impactos
            gameState.budget -= selectedOption.cost;
            gameState.timeRemaining -= selectedOption.time;
            
            Object.entries(selectedOption.impact).forEach(([key, value]) => {
                if (gameState.metrics[key]) {
                    gameState.metrics[key] = Math.min(100, Math.max(0, gameState.metrics[key] + value));
                } else if (gameState.stakeholders[key]) {
                    gameState.stakeholders[key].satisfaction = Math.min(100, Math.max(0, gameState.stakeholders[key].satisfaction + value));
                }
            });
            
            // Guardar decisi√≥n en historial
            gameState.decisionsHistory.push({
                phase: gameState.currentPhase,
                decision: decision.id,
                option: gameState.currentSelectedOption,
                timestamp: new Date(),
                impact: selectedOption.impact
            });
            
            closeDecisionModal();
            
            // Mostrar feedback educativo
            showFeedbackModal(
                'Decisi√≥n Ejecutada',
                `Has elegido: ${selectedOption.title}. Esta decisi√≥n afectar√° el desarrollo del proyecto y la satisfacci√≥n de stakeholders.`,
                'info',
                {
                    'An√°lisis de Decisi√≥n': `Los beneficios incluyen: ${selectedOption.benefits.join(', ')}. Los riesgos a gestionar son: ${selectedOption.risks.join(', ')}.`
                }
            );
            
            addNotification(`Decisi√≥n tomada: ${selectedOption.title}`, 'info');
            updateDashboard();
        }

        function closeDecisionModal() {
            document.getElementById('decision-modal').style.display = 'none';
            gameState.currentDecision = null;
            gameState.currentSelectedOption = null;
        }

        // Funci√≥n para mostrar feedback educativo
        function showFeedbackModal(title, content, type = 'info', isoStandards = {}, lessons = []) {
            document.getElementById('feedback-title').textContent = `${type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : 'üìö'} ${title}`;
            
            document.getElementById('feedback-content').innerHTML = `
                <div class="feedback-text">
                    <p>${content}</p>
                </div>
            `;
            
            if (Object.keys(isoStandards).length > 0) {
                document.getElementById('iso-standards-applied').innerHTML = `
                    <h4>üìã Est√°ndares ISO Aplicados:</h4>
                    ${Object.entries(isoStandards).map(([standard, description]) => `
                        <div class="iso-item">
                            <strong>${standard}:</strong> ${description}
                        </div>
                    `).join('')}
                `;
            } else {
                document.getElementById('iso-standards-applied').innerHTML = '';
            }
            
            if (lessons.length > 0) {
                document.getElementById('lessons-learned').innerHTML = `
                    <h4>üéì Lecciones Aprendidas:</h4>
                    <ul>
                        ${lessons.map(lesson => `<li>${lesson}</li>`).join('')}
                    </ul>
                `;
            } else {
                document.getElementById('lessons-learned').innerHTML = '';
            }
            
            document.getElementById('feedback-modal').style.display = 'flex';
        }

        function closeFeedbackModal() {
            document.getElementById('feedback-modal').style.display = 'none';
        }

        // Funci√≥n para actualizar dashboard
        function updateDashboard() {
            // Actualizar estado del proyecto
            document.getElementById('current-phase').textContent = `${gameState.currentPhase}/${gameState.totalPhases}`;
            document.getElementById('budget-display').textContent = `‚Ç¨${gameState.budget.toLocaleString()}`;
            document.getElementById('time-remaining').textContent = `${gameState.timeRemaining} meses`;
            
            // Actualizar m√©tricas
            Object.entries(gameState.metrics).forEach(([metric, value]) => {
                const scoreElement = document.getElementById(`${metric}-score`);
                const progressElement = document.getElementById(`${metric}-progress`);
                
                if (scoreElement) {
                    scoreElement.textContent = Math.round(value);
                }
                if (progressElement) {
                    progressElement.style.width = `${value}%`;
                }
            });
            
            // Actualizar satisfacci√≥n de stakeholders
            Object.entries(gameState.stakeholders).forEach(([stakeholder, data]) => {
                const satisfactionElement = document.getElementById(`${stakeholder}-satisfaction`);
                if (satisfactionElement) {
                    satisfactionElement.style.width = `${data.satisfaction}%`;
                    satisfactionElement.parentElement.nextElementSibling.textContent = `${Math.round(data.satisfaction)}%`;
                }
            });
            
            // Actualizar salud general del proyecto
            const avgScore = Object.values(gameState.metrics).reduce((a, b) => a + b, 0) / Object.keys(gameState.metrics).length;
            const healthIndicator = document.querySelector('.health-indicator');
            const healthText = document.querySelector('.overall-health span:last-child');
            
            if (avgScore >= 75) {
                healthIndicator.className = 'health-indicator excellent';
                healthText.textContent = 'Proyecto Excelente';
            } else if (avgScore >= 60) {
                healthIndicator.className = 'health-indicator good';
                healthText.textContent = 'Proyecto Saludable';
            } else if (avgScore >= 40) {
                healthIndicator.className = 'health-indicator warning';
                healthText.textContent = 'Proyecto en Riesgo';
            } else {
                healthIndicator.className = 'health-indicator critical';
                healthText.textContent = 'Proyecto Cr√≠tico';
            }
        }

        // Funci√≥n para a√±adir notificaciones
        function addNotification(message, type = 'info') {
            const notification = {
                id: Date.now(),
                message,
                type,
                timestamp: new Date()
            };
            
            gameState.notifications.unshift(notification);
            
            // Mantener solo las √∫ltimas 10 notificaciones
            if (gameState.notifications.length > 10) {
                gameState.notifications = gameState.notifications.slice(0, 10);
            }
            
            updateNotificationsDisplay();
        }

        function updateNotificationsDisplay() {
            const notificationsList = document.getElementById('notifications-list');
            
            notificationsList.innerHTML = gameState.notifications.map(notification => `
                <div class="notification-item ${notification.type}">
                    <div class="notification-content">
                        <span class="notification-icon">${getNotificationIcon(notification.type)}</span>
                        <span class="notification-message">${notification.message}</span>
                    </div>
                    <div class="notification-time">
                        ${notification.timestamp.toLocaleTimeString()}
                    </div>
                </div>
            `).join('');
        }

        function getNotificationIcon(type) {
            const icons = {
                'success': '‚úÖ',
                'warning': '‚ö†Ô∏è',
                'error': '‚ùå',
                'info': '‚ÑπÔ∏è'
            };
            return icons[type] || '‚ÑπÔ∏è';
        }

        // Inicializar el juego cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            updateDashboard();
            updateNotificationsDisplay();
            initializeDraggablePanel();
        });

        // Funciones para panel de notificaciones movible
        function initializeDraggablePanel() {
            const panel = document.getElementById('notifications-panel');
            const header = document.getElementById('notifications-header');
            let isDragging = false;
            let currentX;
            let currentY;
            let initialX;
            let initialY;
            let xOffset = 0;
            let yOffset = 0;

            header.addEventListener('mousedown', dragStart);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', dragEnd);

            function dragStart(e) {
                if (e.target.closest('.move-btn')) {
                    initialX = e.clientX - xOffset;
                    initialY = e.clientY - yOffset;
                    isDragging = true;
                    panel.style.cursor = 'grabbing';
                }
            }

            function drag(e) {
                if (isDragging) {
                    e.preventDefault();
                    currentX = e.clientX - initialX;
                    currentY = e.clientY - initialY;
                    xOffset = currentX;
                    yOffset = currentY;
                    panel.style.transform = `translate(${currentX}px, ${currentY}px)`;
                }
            }

            function dragEnd(e) {
                isDragging = false;
                panel.style.cursor = 'default';
            }
        }

        function toggleNotificationsPanel() {
            const panel = document.getElementById('notifications-panel');
            const list = document.getElementById('notifications-list');
            const minimizeBtn = panel.querySelector('.minimize-btn');
            
            if (list.style.display === 'none') {
                list.style.display = 'block';
                minimizeBtn.textContent = '‚àí';
                minimizeBtn.title = 'Minimizar';
            } else {
                list.style.display = 'none';
                minimizeBtn.textContent = '+';
                minimizeBtn.title = 'Maximizar';
            }
        }

        function showNotificationsHelp() {
            showFeedbackModal(
                'Ayuda: Panel de Notificaciones',
                'Este panel te mantiene informado sobre el progreso del proyecto y decisiones tomadas. Puedes minimizarlo con el bot√≥n "‚àí" o moverlo arrastrando desde el icono "‚ãÆ‚ãÆ".',
                'info',
                {
                    'Funcionalidades': 'Minimizar/maximizar, mover por pantalla, historial de acciones',
                    'Tip': 'Las notificaciones m√°s recientes aparecen arriba. Usa esto para revisar tu historial de decisiones.'
                }
            );
        }

        function showRequirementHelp(requirementId) {
            const requirement = Object.values(requirementsCatalog).flat().find(req => req.id === requirementId);
            if (!requirement) return;

            const helpContent = requirement.isDistractor ? 
                `<div class="warning-help">‚ö†Ô∏è ADVERTENCIA: Esta es una opci√≥n problem√°tica que puede perjudicar tu proyecto.</div>
                 <p><strong>Raz√≥n:</strong> ${requirement.distractorReason}</p>
                 <p><strong>Est√°ndar ISO:</strong> ${requirement.iso_standard}</p>` :
                `<p><strong>Beneficio ISO:</strong> ${requirement.iso_benefit}</p>
                 <p><strong>Est√°ndar Aplicable:</strong> ${requirement.iso_standard}</p>
                 <p><strong>Recomendaci√≥n:</strong> Esta opci√≥n est√° alineada con las mejores pr√°cticas de ingenier√≠a de software.</p>`;

            showFeedbackModal(
                `Ayuda ISO: ${requirement.title}`,
                helpContent,
                requirement.isDistractor ? 'warning' : 'info',
                {},
                requirement.isDistractor ? [] : [
                    'Los est√°ndares ISO proporcionan marcos probados para la gesti√≥n de proyectos',
                    'Cada requisito debe evaluarse por su alineaci√≥n con est√°ndares internacionales',
                    'Las opciones distractoras pueden parecer atractivas pero suelen tener riesgos ocultos'
                ]
            );
        }

        function addISOTip(element, isoInfo, tipText) {
            const tipButton = document.createElement('button');
            tipButton.className = 'iso-tip-btn';
            tipButton.innerHTML = '‚ÑπÔ∏è';
            tipButton.title = tipText;
            tipButton.onclick = (e) => {
                e.stopPropagation();
                showFeedbackModal(
                    'Informaci√≥n ISO',
                    isoInfo,
                    'info'
                );
            };
            element.appendChild(tipButton);
        }

        // Funciones espec√≠ficas para avanzar entre fases
        function advanceToPhase2() {
            if (gameState.selectedRequirements.length < 5) {
                showFeedbackModal('Requisitos Incompletos', 'Debes seleccionar al menos 5 requisitos antes de avanzar a la fase de dise√±o.', 'warning');
                return;
            }
            
            gameState.currentPhase = 2;
            gameState.timeRemaining -= 2;
            addNotification('Avanzando a Fase 2: Dise√±o y Arquitectura', 'success');
            loadPhaseContent();
        }

        function advanceToPhase3() {
            if (gameState.decisionsHistory.filter(d => d.phase === 2).length < 2) {
                showFeedbackModal('Arquitectura Incompleta', 'Debes tomar al menos 2 decisiones arquitecturales antes de proceder al desarrollo.', 'warning');
                return;
            }
            
            gameState.currentPhase = 3;
            gameState.timeRemaining -= 3;
            addNotification('Avanzando a Fase 3: Desarrollo e Implementaci√≥n', 'success');
            loadPhaseContent();
        }

        function advanceToPhase4() {
            if (gameState.decisionsHistory.filter(d => d.phase === 3).length < 3) {
                showFeedbackModal('Implementaci√≥n Incompleta', 'Debes completar las 3 decisiones cr√≠ticas de implementaci√≥n antes del go-live.', 'warning');
                return;
            }
            
            gameState.currentPhase = 4;
            gameState.timeRemaining -= 2;
            addNotification('¬°FASE FINAL! Preparando para Go-Live...', 'warning');
            loadPhaseContent();
        }

        function showArchitectureAnalysis() {
            showFeedbackModal(
                'An√°lisis de Arquitectura',
                'El an√°lisis muestra que la arquitectura elegida debe balancear m√∫ltiples factores cr√≠ticos para el entorno hospitalario.',
                'info',
                {
                    'ISO 12207': 'Define el proceso de dise√±o arquitectural considerando interfaces, datos y comportamiento.',
                    'Consideraciones Cr√≠ticas': 'Rendimiento en emergencias, escalabilidad para crecimiento, seguridad para datos m√©dicos.'
                },
                [
                    'La arquitectura es la decisi√≥n m√°s cr√≠tica del proyecto',
                    'Los costos de cambio arquitectural post-implementaci√≥n son extremadamente altos',
                    'La escalabilidad debe considerar el crecimiento del hospital en 10+ a√±os'
                ]
            );
        }

        function showImplementationRisks() {
            const riskLevel = calculateImplementationRisk();
            showFeedbackModal(
                'An√°lisis de Riesgos de Implementaci√≥n',
                `Nivel de riesgo actual: <strong>${riskLevel}</strong>. La implementaci√≥n en un hospital activo presenta riesgos √∫nicos que deben mitigarse cuidadosamente.`,
                riskLevel === 'CR√çTICO' ? 'error' : riskLevel === 'ALTO' ? 'warning' : 'info',
                {
                    'Riesgos Identificados': 'Interrupciones en atenci√≥n cr√≠tica, p√©rdida de datos m√©dicos, resistencia del personal',
                    'Mitigaciones Requeridas': 'Pruebas exhaustivas, rollback plan, capacitaci√≥n intensiva, monitoreo 24/7'
                }
            );
        }

        function calculateImplementationRisk() {
            const budgetRisk = gameState.budget < 500000 ? 2 : gameState.budget < 1000000 ? 1 : 0;
            const timeRisk = gameState.timeRemaining < 3 ? 2 : gameState.timeRemaining < 6 ? 1 : 0;
            const stakeholderRisk = Object.values(gameState.stakeholders).some(s => s.satisfaction < 50) ? 2 : Object.values(gameState.stakeholders).some(s => s.satisfaction < 70) ? 1 : 0;
            
            const totalRisk = budgetRisk + timeRisk + stakeholderRisk;
            
            if (totalRisk >= 5) return 'CR√çTICO';
            if (totalRisk >= 3) return 'ALTO';
            if (totalRisk >= 1) return 'MODERADO';
            return 'BAJO';
        }

        function showFinalRiskAssessment() {
            const finalAssessment = generateFinalAssessment();
            showFeedbackModal(
                'Evaluaci√≥n Final de Riesgos - Pre-Despliegue',
                finalAssessment.summary,
                finalAssessment.level === 'CR√çTICO' ? 'error' : 'warning',
                {
                    'Estado del Proyecto': finalAssessment.projectStatus,
                    'Recomendaci√≥n': finalAssessment.recommendation
                }
            );
        }

        function generateFinalAssessment() {
            const avgMetrics = Object.values(gameState.metrics).reduce((a, b) => a + b, 0) / Object.keys(gameState.metrics).length;
            const avgSatisfaction = Object.values(gameState.stakeholders).reduce((acc, s) => acc + s.satisfaction, 0) / Object.keys(gameState.stakeholders).length;
            const decisionsComplete = gameState.decisionsHistory.length;
            
            let level, summary, projectStatus, recommendation;
            
            if (avgMetrics >= 75 && avgSatisfaction >= 70 && gameState.budget > 200000 && decisionsComplete >= 6) {
                level = '√ìPTIMO';
                summary = 'üéâ ¬°Excelente! El proyecto est√° en condiciones √≥ptimas para el despliegue.';
                projectStatus = 'Todas las m√©tricas est√°n en rangos aceptables. El equipo est√° preparado.';
                recommendation = 'Proceder con el despliegue seg√∫n lo planificado.';
            } else if (avgMetrics >= 60 && avgSatisfaction >= 60 && gameState.budget > 100000) {
                level = 'ACEPTABLE';
                summary = '‚ö†Ô∏è El proyecto tiene riesgos moderados pero es viable para despliegue.';
                projectStatus = 'M√©tricas aceptables con algunas √°reas de mejora identificadas.';
                recommendation = 'Proceder con precauci√≥n adicional y monitoreo intensivo.';
            } else {
                level = 'CR√çTICO';
                summary = 'üö® ALTO RIESGO: El proyecto presenta serias deficiencias que podr√≠an comprometer vidas.';
                projectStatus = 'M√∫ltiples m√©tricas cr√≠ticas por debajo del umbral de seguridad.';
                recommendation = 'RETRASAR el despliegue hasta resolver las deficiencias cr√≠ticas.';
            }
            
            return { level, summary, projectStatus, recommendation };
        }

        function completeProject() {
            const finalAssessment = generateFinalAssessment();
            
            if (finalAssessment.level === 'CR√çTICO' && !confirm('‚ö†Ô∏è ADVERTENCIA: El proyecto presenta riesgos cr√≠ticos. ¬øEst√°s seguro de que quieres proceder con el despliegue? Esto podr√≠a tener consecuencias graves.')) {
                return;
            }
            
            gameState.isCompleted = true;
            gameState.completionDate = new Date();
            gameState.finalScore = calculateFinalScore();
            
            showProjectCompletionScreen();
        }

        function calculateFinalScore() {
            const metricsScore = Object.values(gameState.metrics).reduce((a, b) => a + b, 0) / Object.keys(gameState.metrics).length;
            const stakeholderScore = Object.values(gameState.stakeholders).reduce((acc, s) => acc + s.satisfaction, 0) / Object.keys(gameState.stakeholders).length;
            const budgetEfficiency = Math.max(0, (gameState.budget / 2500000) * 100);
            const timeEfficiency = Math.max(0, (gameState.timeRemaining / 18) * 100);
            const decisionsBonus = Math.min(20, gameState.decisionsHistory.length * 2);
            
            return Math.round((metricsScore * 0.4 + stakeholderScore * 0.3 + budgetEfficiency * 0.15 + timeEfficiency * 0.15) + decisionsBonus);
        }

        function showProjectCompletionScreen() {
            const mainContent = document.getElementById('main-content');
            const finalScore = gameState.finalScore;
            const assessment = generateFinalAssessment();
            
            let gradeEmoji, gradeText, gradeDescription;
            
            if (finalScore >= 90) {
                gradeEmoji = 'üèÜ';
                gradeText = 'EXCELENCIA';
                gradeDescription = 'Has demostrado maestr√≠a excepcional en la gesti√≥n de proyectos de software hospitalario.';
            } else if (finalScore >= 80) {
                gradeEmoji = 'ü•á';
                gradeText = 'SOBRESALIENTE';
                gradeDescription = 'Excelente gesti√≥n del proyecto con aplicaci√≥n s√≥lida de est√°ndares ISO.';
            } else if (finalScore >= 70) {
                gradeEmoji = 'ü•à';
                gradeText = 'NOTABLE';
                gradeDescription = 'Buena gesti√≥n del proyecto con algunos aspectos mejorables.';
            } else if (finalScore >= 60) {
                gradeEmoji = 'ü•â';
                gradeText = 'APROBADO';
                gradeDescription = 'Proyecto completado satisfactoriamente con oportunidades de mejora.';
            } else {
                gradeEmoji = '‚ùå';
                gradeText = 'CR√çTICO';
                gradeDescription = 'El proyecto presenta serios problemas que comprometen su viabilidad.';
            }
            
            mainContent.innerHTML = `
                <div class="completion-screen">
                    <div class="completion-header">
                        <h1>${gradeEmoji} Proyecto MedCore Completado</h1>
                        <div class="hospital-final">
                            <h2>üè• Hospital San Rafael</h2>
                            <p>Sistema de Gesti√≥n Hospitalaria MedCore</p>
                        </div>
                    </div>
                    
                    <div class="final-assessment">
                        <div class="score-card">
                            <div class="score-display">
                                <span class="score-number">${finalScore}</span>
                                <span class="score-total">/100</span>
                            </div>
                            <div class="grade-info">
                                <div class="grade-title">${gradeText}</div>
                                <div class="grade-description">${gradeDescription}</div>
                            </div>
                        </div>
                        
                        <div class="project-summary">
                            <h3>üìä Resumen del Proyecto</h3>
                            <div class="summary-grid">
                                <div class="summary-item">
                                    <span class="summary-label">Presupuesto Final</span>
                                    <span class="summary-value">‚Ç¨${gameState.budget.toLocaleString()}</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-label">Tiempo Restante</span>
                                    <span class="summary-value">${gameState.timeRemaining} meses</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-label">Decisiones Tomadas</span>
                                    <span class="summary-value">${gameState.decisionsHistory.length}</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-label">Requisitos Seleccionados</span>
                                    <span class="summary-value">${gameState.selectedRequirements.length}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stakeholder-final">
                            <h3>üë• Satisfacci√≥n Final de Stakeholders</h3>
                            <div class="stakeholder-scores">
                                <div class="stakeholder-final-item">
                                    <span>üë©‚Äç‚öïÔ∏è Dra. Mar√≠a Gonz√°lez</span>
                                    <span>${Math.round(gameState.stakeholders.maria.satisfaction)}%</span>
                                </div>
                                <div class="stakeholder-final-item">
                                    <span>üë®‚Äçüíº Ing. Carlos M√©ndez</span>
                                    <span>${Math.round(gameState.stakeholders.carlos.satisfaction)}%</span>
                                </div>
                                <div class="stakeholder-final-item">
                                    <span>üë©‚Äçüíº Lic. Ana Ruiz</span>
                                    <span>${Math.round(gameState.stakeholders.ana.satisfaction)}%</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="iso-standards-applied-final">
                            <h3>üìö Est√°ndares ISO Aplicados</h3>
                            <div class="iso-list">
                                <span class="iso-badge">ISO 29148 - Gesti√≥n de Requisitos</span>
                                <span class="iso-badge">ISO 25010 - Calidad del Software</span>
                                <span class="iso-badge">ISO 12207 - Procesos de Ciclo de Vida</span>
                                <span class="iso-badge">ISO 9241 - Ergonom√≠a e Interacci√≥n</span>
                            </div>
                        </div>
                        
                        <div class="lessons-learned-final">
                            <h3>üéì Lecciones Clave Aprendidas</h3>
                            <ul>
                                <li>La gesti√≥n de stakeholders es cr√≠tica en proyectos hospitalarios</li>
                                <li>Las decisiones arquitecturales tienen impacto a largo plazo</li>
                                <li>Los est√°ndares ISO proporcionan marco estructural esencial</li>
                                <li>El balance entre funcionalidad y usabilidad es crucial en entornos m√©dicos</li>
                                <li>La gesti√≥n de riesgos es vital cuando las vidas est√°n en juego</li>
                            </ul>
                        </div>
                        
                        <div class="completion-actions">
                            <button class="action-btn primary large" onclick="downloadProjectReport()">
                                üìÑ Descargar Reporte del Proyecto
                            </button>
                            <button class="action-btn secondary" onclick="location.reload()">
                                üîÑ Iniciar Nuevo Proyecto
                            </button>
                            <button class="action-btn info" onclick="showDetailedAnalysis()">
                                üìä An√°lisis Detallado
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function downloadProjectReport() {
            // Funcionalidad para descargar reporte (simulada)
            showFeedbackModal(
                'Reporte Generado',
                'El reporte detallado del proyecto ha sido generado exitosamente. En un entorno real, este documento incluir√≠a todas las decisiones tomadas, m√©tricas finales y lecciones aprendidas para futuras referencias.',
                'success'
            );
        }

        function showDetailedAnalysis() {
            showFeedbackModal(
                'An√°lisis Detallado del Proyecto',
                `Tu proyecto ha demostrado la aplicaci√≥n pr√°ctica de est√°ndares de ingenier√≠a de software en un entorno cr√≠tico como es un hospital. Las decisiones tomadas reflejan la complejidad real de gestionar proyectos donde la tecnolog√≠a debe servir a objetivos humanos vitales.`,
                'info',
                {
                    'Fortalezas Identificadas': 'Aplicaci√≥n sistem√°tica de est√°ndares ISO, consideraci√≥n de factores humanos, gesti√≥n equilibrada de recursos.',
                    '√Åreas de Mejora': 'Optimizaci√≥n de costos, mejora en comunicaci√≥n con stakeholders, anticipaci√≥n de riesgos t√©cnicos.'
                },
                [
                    'Los proyectos hospitalarios requieren una perspectiva multidisciplinaria',
                    'La gesti√≥n de stakeholders es tan importante como la gesti√≥n t√©cnica',
                    'Los est√°ndares ISO son herramientas pr√°cticas, no obst√°culos burocr√°ticos',
                    'El √©xito se mide tanto en m√©tricas t√©cnicas como en impacto humano'
                ]
            );
        }

        // Verificaci√≥n de carga completa
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üéÆ MedCore DOM cargado completamente');
            console.log('üéØ gameState:', gameState);
            console.log('üìã requirementsCatalog:', Object.keys(requirementsCatalog).length + ' categor√≠as');
            console.log('‚öôÔ∏è phaseDecisions:', Object.keys(phaseDecisions).length + ' fases');
            console.log('‚úÖ Tutorial listo para usar');
        });

        // Manejo global de errores
        window.addEventListener('error', function(event) {
            console.error('üö® Error global capturado:', event.error);
            console.error('üìç Archivo:', event.filename, 'L√≠nea:', event.lineno);
        });
    </script>
</body>
</html>